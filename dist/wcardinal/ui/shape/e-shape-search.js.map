{"version":3,"file":"e-shape-search.js","sourceRoot":"","sources":["../../../../src/main/typescript/wcardinal/ui/shape/e-shape-search.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { EShape } from \"./e-shape\";\r\nimport { EShapeContainer } from \"./e-shape-container\";\r\nimport { EShapeType } from \"./e-shape-type\";\r\nimport { EShapeBase } from \"./variant/e-shape-base\";\r\n\r\nexport class EShapeSearch {\r\n\tstatic COMPARATOR_INDEX = ( a: EShape, b: EShape ): number => {\r\n\t\treturn a.index - b.index;\r\n\t}\r\n\r\n\tstatic toIndices( shapes: EShape[] ): number[] {\r\n\t\tconst result = [];\r\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\r\n\t\t\tresult.push( shapes[ i ].index );\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tstatic toDepth( shape: EShape ): number {\r\n\t\tlet result = 0;\r\n\t\tlet parent = shape.parent;\r\n\t\twhile( parent instanceof EShapeBase ) {\r\n\t\t\tresult += 1;\r\n\t\t\tparent = parent.parent;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tstatic toSharedParent( first: EShape, shape: EShape ): EShape | EShapeContainer {\r\n\t\tconst depthA = this.toDepth( first );\r\n\t\tconst depthB = this.toDepth( shape );\r\n\t\tif( depthA < depthB ) {\r\n\t\t\tlet parent = first.parent;\r\n\t\t\twhile( parent instanceof EShapeBase ) {\r\n\t\t\t\tif( this.isParent( shape, parent ) ) {\r\n\t\t\t\t\treturn parent;\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parent;\r\n\t\t\t}\r\n\t\t\treturn parent!;\r\n\t\t} else {\r\n\t\t\tlet parent = shape.parent;\r\n\t\t\twhile( parent instanceof EShapeBase ) {\r\n\t\t\t\tif( this.isParent( first, parent ) ) {\r\n\t\t\t\t\treturn parent;\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parent;\r\n\t\t\t}\r\n\t\t\treturn parent!;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic toOfParent( shape: EShape, parent: EShape | EShapeContainer ) {\r\n\t\tlet shapeParent = shape.parent;\r\n\t\twhile( shapeParent !== parent && shapeParent instanceof EShapeBase ) {\r\n\t\t\tshape = shapeParent;\r\n\t\t\tshapeParent = shapeParent.parent;\r\n\t\t}\r\n\t\treturn shape;\r\n\t}\r\n\r\n\tstatic isParent( shape: EShape, target: EShape | null ): boolean {\r\n\t\tlet parent = shape.parent;\r\n\t\twhile( parent instanceof EShapeBase ) {\r\n\t\t\tif( parent === target ) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tparent = parent.parent;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tstatic toSelected( shape: EShape ): EShape | null {\r\n\t\tlet target: EShape | EShapeContainer | null = shape;\r\n\t\twhile( target instanceof EShapeBase ) {\r\n\t\t\tif( target.selected ) {\r\n\t\t\t\treturn target;\r\n\t\t\t}\r\n\t\t\ttarget = target.parent;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tstatic findChildById( shape: { children: EShape[] }, id: string, recursively?: boolean ): EShape | null {\r\n\t\tconst children = shape.children;\r\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\r\n\t\t\tconst child = children[ i ];\r\n\t\t\tif( child.id === id ) {\r\n\t\t\t\treturn child;\r\n\t\t\t}\r\n\t\t\tif( recursively === true ) {\r\n\t\t\t\tconst result = EShapeSearch.findChildById( child, id, recursively );\r\n\t\t\t\tif( result != null ) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tstatic findChildByType( shape: { children: EShape[] }, type: EShapeType, recursively?: boolean ): EShape | null {\r\n\t\tconst children = shape.children;\r\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\r\n\t\t\tconst child = children[ i ];\r\n\t\t\tif( child.type === type ) {\r\n\t\t\t\treturn child;\r\n\t\t\t}\r\n\t\t\tif( recursively === true ) {\r\n\t\t\t\tconst result = EShapeSearch.findChildByType( child, type, recursively );\r\n\t\t\t\tif( result != null ) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tstatic findChild(\r\n\t\tshape: { children: EShape[] }, matcher: ( shape: EShape ) => boolean, recursively?: boolean\r\n\t): EShape | null {\r\n\t\tconst children = shape.children;\r\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\r\n\t\t\tconst child = children[ i ];\r\n\t\t\tif( matcher( child ) ) {\r\n\t\t\t\treturn child;\r\n\t\t\t}\r\n\t\t\tif( recursively === true ) {\r\n\t\t\t\tconst result = EShapeSearch.findChild( child, matcher, recursively );\r\n\t\t\t\tif( result != null ) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tstatic findChildrenByType(\r\n\t\tshape: { children: EShape[] }, type: EShapeType, recursively?: boolean, result?: EShape[]\r\n\t): EShape[] {\r\n\t\tresult = result || [];\r\n\t\tconst children = shape.children;\r\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\r\n\t\t\tconst child = children[ i ];\r\n\t\t\tif( child.type === type ) {\r\n\t\t\t\tresult.push( child );\r\n\t\t\t}\r\n\t\t\tif( recursively === true ) {\r\n\t\t\t\tEShapeSearch.findChildrenByType( child, type, recursively, result );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tstatic findChildren(\r\n\t\tshape: { children: EShape[] }, matcher: ( shape: EShape ) => boolean, recursively?: boolean, result?: EShape[]\r\n\t): EShape[] {\r\n\t\tresult = result || [];\r\n\t\tconst children = shape.children;\r\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\r\n\t\t\tconst child = children[ i ];\r\n\t\t\tif( matcher( child ) ) {\r\n\t\t\t\tresult.push( child );\r\n\t\t\t}\r\n\t\t\tif( recursively === true ) {\r\n\t\t\t\tEShapeSearch.findChildren( child, matcher, recursively, result );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n}\r\n"]}