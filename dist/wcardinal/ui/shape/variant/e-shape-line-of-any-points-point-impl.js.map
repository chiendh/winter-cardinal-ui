{"version":3,"file":"e-shape-line-of-any-points-point-impl.js","sourceRoot":"","sources":["../../../../../src/main/typescript/wcardinal/ui/shape/variant/e-shape-line-of-any-points-point-impl.ts"],"names":[],"mappings":"AAAA;;;GAGG;AAEH,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE,MAAM,YAAY,CAAC;AAGlD,OAAO,EAAE,QAAQ,EAAE,MAAM,aAAa,CAAC;AACvC,OAAO,EAAE,UAAU,EAAE,MAAM,eAAe,CAAC;AAO3C;IAYC,wCAAa,MAA4C,EAAE,IAAY,EAAE,IAAY;QACpF,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;QACb,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC;QACf,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC;QACf,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACnB,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC;QACxB,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;QACnB,IAAI,CAAC,kBAAkB,GAAG,CAAC,CAAC;IAC7B,CAAC;IAED,sBAAI,8CAAE;aAAN;YACC,OAAO,IAAI,CAAC,GAAG,CAAC;QACjB,CAAC;;;OAAA;IAED,sBAAI,6CAAC;aAAL;YACC,OAAO,IAAI,CAAC,EAAE,CAAC;QAChB,CAAC;aAED,UAAO,CAAuB;YAC7B,IAAI,CAAC,GAAG,CAAE,CAAC,EAAE,SAAS,CAAE,CAAC;QAC1B,CAAC;;;OAJA;IAMD,sBAAI,6CAAC;aAAL;YACC,OAAO,IAAI,CAAC,EAAE,CAAC;QAChB,CAAC;aAED,UAAO,CAAuB;YAC7B,IAAI,CAAC,GAAG,CAAE,SAAS,EAAE,CAAC,CAAE,CAAC;QAC1B,CAAC;;;OAJA;IAMD,sBAAI,iDAAK;aAAT;YACC,OAAO,IAAI,CAAC,MAAM,CAAC;QACpB,CAAC;aAED,UAAW,KAAoB;YAC9B,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACrB,CAAC;;;OAJA;IAMD,4CAAG,GAAH,UAAK,CAAwB,EAAE,CAAwB;QACtD,IAAI,SAAS,GAAG,KAAK,CAAC;QAEtB,IAAI,CAAC,KAAK,SAAS,IAAI,IAAI,CAAC,EAAE,KAAK,CAAC,EAAG;YACtC,SAAS,GAAG,IAAI,CAAC;YACjB,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;SACZ;QAED,IAAI,CAAC,KAAK,SAAS,IAAI,IAAI,CAAC,EAAE,KAAK,CAAC,EAAG;YACtC,SAAS,GAAG,IAAI,CAAC;YACjB,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;SACZ;QAED,IAAI,SAAS,EAAG;YACf,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC;YACd,IAAI,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC;SAC9B;IACF,CAAC;IAED,6CAAI,GAAJ,UAAM,KAAa;QAClB,OAAO,UAAU,CAAE,KAAK,EAAE,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,KAAK,CAAE,CAAC;IACjD,CAAC;IAED,6CAAI,GAAJ,UAAM,KAAa;QAClB,OAAO,UAAU,CAAE,KAAK,EAAE,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,KAAK,CAAE,CAAC;IACjD,CAAC;IAED,iDAAQ,GAAR;QACC,IAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;QAC1B,IAAI,KAAK,IAAI,IAAI,EAAG;YACnB,OAAO,KAAK,CAAC;SACb;QACD,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAC3B,OAAO,IAAI,CAAC,cAAc,CAAC;IAC5B,CAAC;IAES,4DAAmB,GAA7B;QACC,IAAM,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC;QACzB,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;QAC5B,IAAM,iBAAiB,GAAG,MAAM,CAAC,MAAM,CAAC;QACxC,IAAI,IAAI,CAAC,QAAQ,KAAK,OAAO,IAAI,IAAI,CAAC,kBAAkB,KAAK,iBAAiB,EAAG;YAChF,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;YACxB,IAAI,CAAC,kBAAkB,GAAG,iBAAiB,CAAC;YAC5C,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,GAAG,CAC7B,IAAI,CAAC,SAAS,CAAE,IAAI,CAAC,EAAE,EAAE,iBAAiB,EAAE,IAAI,CAAC,KAAK,CAAE,EACxD,IAAI,CAAC,SAAS,CAAE,IAAI,CAAC,EAAE,EAAE,iBAAiB,EAAE,IAAI,CAAC,KAAK,CAAE,CACxD,CAAC;SACF;IACF,CAAC;IAES,kDAAS,GAAnB,UAAqB,KAA2B,EAAE,YAAoB,EAAE,GAAW;QAClF,IAAI,QAAQ,CAAE,KAAK,CAAE,EAAG;YACvB,OAAO,IAAI,CAAC,GAAG,CAAE,KAAK,CAAE,CAAC;SACzB;aAAM,IAAI,UAAU,CAAE,KAAK,CAAE,EAAG;YAChC,IAAI,CAAC,GAAG,YAAY,EAAG;gBACtB,IAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAE,KAAK,CAAE,CAAC,CAAE,CAAE,CAAC;gBACpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,EAAE,EAAE,CAAC,EAAG;oBACvC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAE,MAAM,EAAE,IAAI,CAAC,GAAG,CAAE,KAAK,CAAE,CAAC,CAAE,CAAE,CAAE,CAAC;iBACpD;gBACD,OAAO,MAAM,CAAC;aACd;YACD,OAAO,CAAC,CAAC;SACT;aAAM,IAAI,KAAK,IAAI,IAAI,EAAG;YAC1B,IAAM,CAAC,GAAG,KAAK,CAAC,MAAM,CAAC;YACvB,IAAI,CAAC,GAAG,CAAC,EAAG;gBACX,IAAI,MAAM,GAAG,KAAK,CAAE,CAAC,CAAE,CAAC;gBACxB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAG;oBAC5B,MAAM,GAAG,IAAI,CAAC,GAAG,CAAE,MAAM,EAAE,IAAI,CAAC,GAAG,CAAE,KAAK,CAAE,CAAC,CAAE,CAAE,CAAE,CAAC;iBACpD;gBACD,OAAO,MAAM,CAAC;aACd;YACD,OAAO,CAAC,CAAC;SACT;aAAM;YACN,OAAO,IAAI,CAAC,GAAG,CAAE,GAAG,CAAE,CAAC;SACvB;IACF,CAAC;IAED,kDAAS,GAAT;QACC,OAAO,QAAQ,CAAE,IAAI,CAAC,EAAE,CAAE,CAAC;IAC5B,CAAC;IAED,kDAAS,GAAT;QACC,OAAO,QAAQ,CAAE,IAAI,CAAC,EAAE,CAAE,CAAC;IAC5B,CAAC;IAED,gDAAO,GAAP;QACC,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC;IACf,CAAC;IACF,qCAAC;AAAD,CAAC,AA7ID,IA6IC","sourcesContent":["/*\r\n * Copyright (C) 2020 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { isFunction, isNumber } from \"../../util\";\r\nimport { EShapeLineOfAnyPointsPoint } from \"./e-shape-line-of-any-points-point\";\r\nimport { EShapeLineOfAnyValue } from \"./e-shape-line-of-any-value\";\r\nimport { isStatic } from \"./is-static\";\r\nimport { toComputed } from \"./to-computed\";\r\n\r\nexport interface EShapeLineOfAnyPointsPointImplParent {\r\n\treadonly length: number;\r\n\tupdateUploaded(): void;\r\n}\r\n\r\nexport class EShapeLineOfAnyPointsPointImpl implements EShapeLineOfAnyPointsPoint {\r\n\tprotected _parent: EShapeLineOfAnyPointsPointImplParent;\r\n\tprotected _id: number;\r\n\tprotected _x: EShapeLineOfAnyValue;\r\n\tprotected _y: EShapeLineOfAnyValue;\r\n\tprotected _defX: number;\r\n\tprotected _defY: number;\r\n\tprotected _limit: number | null;\r\n\tprotected _limitComputed: number;\r\n\tprotected _limitId: number;\r\n\tprotected _limitParentLength: number;\r\n\r\n\tconstructor( parent: EShapeLineOfAnyPointsPointImplParent, defX: number, defY: number ) {\r\n\t\tthis._parent = parent;\r\n\t\tthis._id = 0;\r\n\t\tthis._x = null;\r\n\t\tthis._y = null;\r\n\t\tthis._defX = defX;\r\n\t\tthis._defY = defY;\r\n\t\tthis._limit = null;\r\n\t\tthis._limitComputed = 0;\r\n\t\tthis._limitId = -1;\r\n\t\tthis._limitParentLength = 0;\r\n\t}\r\n\r\n\tget id(): number {\r\n\t\treturn this._id;\r\n\t}\r\n\r\n\tget x(): EShapeLineOfAnyValue {\r\n\t\treturn this._x;\r\n\t}\r\n\r\n\tset x( x: EShapeLineOfAnyValue ) {\r\n\t\tthis.set( x, undefined );\r\n\t}\r\n\r\n\tget y(): EShapeLineOfAnyValue {\r\n\t\treturn this._y;\r\n\t}\r\n\r\n\tset y( y: EShapeLineOfAnyValue ) {\r\n\t\tthis.set( undefined, y );\r\n\t}\r\n\r\n\tget limit(): number | null {\r\n\t\treturn this._limit;\r\n\t}\r\n\r\n\tset limit( limit: number | null ) {\r\n\t\tthis._limit = limit;\r\n\t}\r\n\r\n\tset( x?: EShapeLineOfAnyValue, y?: EShapeLineOfAnyValue ): void {\r\n\t\tlet isChanged = false;\r\n\r\n\t\tif( x !== undefined && this._x !== x ) {\r\n\t\t\tisChanged = true;\r\n\t\t\tthis._x = x;\r\n\t\t}\r\n\r\n\t\tif( y !== undefined && this._y !== y ) {\r\n\t\t\tisChanged = true;\r\n\t\t\tthis._y = y;\r\n\t\t}\r\n\r\n\t\tif( isChanged ) {\r\n\t\t\tthis._id += 1;\r\n\t\t\tthis._parent.updateUploaded();\r\n\t\t}\r\n\t}\r\n\r\n\tgetX( index: number ): number {\r\n\t\treturn toComputed( index, this._x, this._defX );\r\n\t}\r\n\r\n\tgetY( index: number ): number {\r\n\t\treturn toComputed( index, this._y, this._defY );\r\n\t}\r\n\r\n\tgetLimit(): number {\r\n\t\tconst limit = this._limit;\r\n\t\tif( limit != null ) {\r\n\t\t\treturn limit;\r\n\t\t}\r\n\t\tthis.updateLimitComputed();\r\n\t\treturn this._limitComputed;\r\n\t}\r\n\r\n\tprotected updateLimitComputed(): void {\r\n\t\tconst limitId = this._id;\r\n\t\tconst parent = this._parent;\r\n\t\tconst limitParentLength = parent.length;\r\n\t\tif( this._limitId !== limitId || this._limitParentLength !== limitParentLength ) {\r\n\t\t\tthis._limitId = limitId;\r\n\t\t\tthis._limitParentLength = limitParentLength;\r\n\t\t\tthis._limitComputed = Math.max(\r\n\t\t\t\tthis.calcLimit( this._x, limitParentLength, this._defX ),\r\n\t\t\t\tthis.calcLimit( this._y, limitParentLength, this._defY )\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected calcLimit( value: EShapeLineOfAnyValue, parentLenght: number, def: number ): number {\r\n\t\tif( isNumber( value ) ) {\r\n\t\t\treturn Math.abs( value );\r\n\t\t} else if( isFunction( value ) ) {\r\n\t\t\tif( 0 < parentLenght ) {\r\n\t\t\t\tlet result = Math.abs( value( 0 ) );\r\n\t\t\t\tfor( let i = 1; i < parentLenght; ++i ) {\r\n\t\t\t\t\tresult = Math.max( result, Math.abs( value( i ) ) );\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t} else if( value != null ) {\r\n\t\t\tconst l = value.length;\r\n\t\t\tif( 0 < l ) {\r\n\t\t\t\tlet result = value[ 0 ];\r\n\t\t\t\tfor( let i = 1; i < l; ++i ) {\r\n\t\t\t\t\tresult = Math.max( result, Math.abs( value[ i ] ) );\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t} else {\r\n\t\t\treturn Math.abs( def );\r\n\t\t}\r\n\t}\r\n\r\n\tisStaticX(): boolean {\r\n\t\treturn isStatic( this._x );\r\n\t}\r\n\r\n\tisStaticY(): boolean {\r\n\t\treturn isStatic( this._y );\r\n\t}\r\n\r\n\ttoDirty(): void {\r\n\t\tthis._id += 1;\r\n\t}\r\n}\r\n"]}