{"version":3,"file":"build-bar.js","sourceRoot":"","sources":["../../../../../src/main/typescript/wcardinal/ui/shape/variant/build-bar.ts"],"names":[],"mappings":"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","sourcesContent":["import { Matrix, Point, TextureUvs } from \"pixi.js\";\r\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\r\nimport { toDash } from \"./to-dash\";\r\nimport { toScaleInvariant } from \"./to-scale-invariant\";\r\n\r\nexport const BAR_VERTEX_COUNT = 4;\r\nexport const BAR_INDEX_COUNT = 2;\r\nconst BAR_FMIN: number = 0.00001;\r\nconst BAR_WORK_POINT: Point = new Point();\r\n\r\nexport const buildBarClipping = (\r\n\tclippings: Float32Array,\r\n\tvoffset: number\r\n): void => {\r\n\tconst ic = voffset * 3;\r\n\tclippings[ ic +  0 ] = 1;\r\n\tclippings[ ic +  1 ] = 0;\r\n\tclippings[ ic +  2 ] = 3;\r\n\r\n\tclippings[ ic +  3 ] = 0;\r\n\tclippings[ ic +  4 ] = 1;\r\n\tclippings[ ic +  5 ] = 5;\r\n\r\n\tclippings[ ic +  6 ] = 1;\r\n\tclippings[ ic +  7 ] = 0;\r\n\tclippings[ ic +  8 ] = 3;\r\n\r\n\tclippings[ ic +  9 ] = 0;\r\n\tclippings[ ic + 10 ] = 1;\r\n\tclippings[ ic + 11 ] = 5;\r\n};\r\n\r\nexport const buildBarIndex = (\r\n\tindices: Uint16Array | Uint32Array,\r\n\tvoffset: number,\r\n\tioffset: number\r\n): void => {\r\n\tconst ii = ioffset * 3;\r\n\tindices[ ii + 0 ] = voffset + 0;\r\n\tindices[ ii + 1 ] = voffset + 2;\r\n\tindices[ ii + 2 ] = voffset + 1;\r\n\r\n\tindices[ ii + 3 ] = voffset + 1;\r\n\tindices[ ii + 4 ] = voffset + 2;\r\n\tindices[ ii + 5 ] = voffset + 3;\r\n};\r\n\r\nexport const buildBarVertexStepAndColorFill = (\r\n\tvertices: Float32Array,\r\n\tsteps: Float32Array,\r\n\tcolorFills: Float32Array,\r\n\tvoffset: number,\r\n\tpointValues: number[],\r\n\tpointsStyle: EShapePointsStyle,\r\n\tpointsSize: number,\r\n\tstrokeWidth: number,\r\n\tinternalTransform: Matrix\r\n): void => {\r\n\t// First point\r\n\tconst a  = internalTransform.a;\r\n\tconst b  = internalTransform.b;\r\n\tconst c  = internalTransform.c;\r\n\tconst d  = internalTransform.d;\r\n\tconst tx = internalTransform.tx;\r\n\tconst ty = internalTransform.ty;\r\n\tconst pv0 = pointValues[ 0 ];\r\n\tconst pv1 = pointValues[ 1 ];\r\n\tconst p1x = a * pv0 + c * pv1 + tx;\r\n\tconst p1y = b * pv0 + d * pv1 + ty;\r\n\r\n\t// Last point\r\n\tconst pv2 = pointValues[ 2 ];\r\n\tconst pv3 = pointValues[ 3 ];\r\n\tlet p2x = a * pv2 + c * pv3 + tx;\r\n\tlet p2y = b * pv2 + d * pv3 + ty;\r\n\r\n\t// Normal\r\n\tlet dx = p2x - p1x;\r\n\tlet dy = p2y - p1y;\r\n\tconst distance = Math.sqrt( dx * dx + dy * dy );\r\n\tlet l = distance;\r\n\tif( 0 <= pointsSize && BAR_FMIN < distance ) {\r\n\t\tconst ratio = pointsSize / distance;\r\n\t\tdx *= ratio;\r\n\t\tdy *= ratio;\r\n\t\tp2x = p1x + dx;\r\n\t\tp2y = p1y + dy;\r\n\t\tl = pointsSize;\r\n\t}\r\n\r\n\t// Other points\r\n\tconst p0x = p1x - dx;\r\n\tconst p0y = p1y - dy;\r\n\tconst p3x = p2x + dx;\r\n\tconst p3y = p2y + dy;\r\n\r\n\t//\r\n\tconst scaleInvariant = toScaleInvariant( pointsStyle );\r\n\tconst iv = voffset << 1;\r\n\tconst icf = voffset << 2;\r\n\tconst is = voffset * 6;\r\n\tvertices[ iv + 0 ] = p1x;\r\n\tvertices[ iv + 1 ] = p1y;\r\n\tvertices[ iv + 2 ] = p1x;\r\n\tvertices[ iv + 3 ] = p1y;\r\n\tsteps[ is +  0 ] = strokeWidth;\r\n\tsteps[ is +  1 ] = scaleInvariant;\r\n\tsteps[ is +  2 ] = p0x;\r\n\tsteps[ is +  3 ] = p0y;\r\n\tsteps[ is +  4 ] = p2x;\r\n\tsteps[ is +  5 ] = p2y;\r\n\tsteps[ is +  6 ] = strokeWidth;\r\n\tsteps[ is +  7 ] = scaleInvariant;\r\n\tsteps[ is +  8 ] = p0x;\r\n\tsteps[ is +  9 ] = p0y;\r\n\tsteps[ is + 10 ] = p2x;\r\n\tsteps[ is + 11 ] = p2y;\r\n\tcolorFills[ icf + 0 ] = 0.0;\r\n\tcolorFills[ icf + 4 ] = 0.0;\r\n\r\n\tvertices[ iv + 4 ] = p2x;\r\n\tvertices[ iv + 5 ] = p2y;\r\n\tvertices[ iv + 6 ] = p2x;\r\n\tvertices[ iv + 7 ] = p2y;\r\n\tsteps[ is + 12 ] = strokeWidth;\r\n\tsteps[ is + 13 ] = scaleInvariant;\r\n\tsteps[ is + 14 ] = p1x;\r\n\tsteps[ is + 15 ] = p1y;\r\n\tsteps[ is + 16 ] = p3x;\r\n\tsteps[ is + 17 ] = p3y;\r\n\tsteps[ is + 18 ] = strokeWidth;\r\n\tsteps[ is + 19 ] = scaleInvariant;\r\n\tsteps[ is + 20 ] = p1x;\r\n\tsteps[ is + 21 ] = p1y;\r\n\tsteps[ is + 22 ] = p3x;\r\n\tsteps[ is + 23 ] = p3y;\r\n\tcolorFills[ icf +  8 ] = l;\r\n\tcolorFills[ icf + 12 ] = l;\r\n\r\n\t// Total length\r\n\tconst dash = toDash( l, strokeWidth, pointsStyle, BAR_WORK_POINT );\r\n\tconst dash0 = dash.x;\r\n\tconst dash1 = dash.y;\r\n\tcolorFills[ icf +  1 ] = dash0;\r\n\tcolorFills[ icf +  2 ] = dash1;\r\n\tcolorFills[ icf +  3 ] = l;\r\n\r\n\tcolorFills[ icf +  5 ] = dash0;\r\n\tcolorFills[ icf +  6 ] = dash1;\r\n\tcolorFills[ icf +  7 ] = l;\r\n\r\n\tcolorFills[ icf +  9 ] = dash0;\r\n\tcolorFills[ icf + 10 ] = dash1;\r\n\tcolorFills[ icf + 11 ] = l;\r\n\r\n\tcolorFills[ icf + 13 ] = dash0;\r\n\tcolorFills[ icf + 14 ] = dash1;\r\n\tcolorFills[ icf + 15 ] = l;\r\n};\r\n\r\nexport const buildBarUv = (\r\n\tuvs: Float32Array,\r\n\tvoffset: number,\r\n\ttextureUvs: TextureUvs\r\n): void => {\r\n\tconst iuv = voffset << 1;\r\n\tuvs[ iuv + 0 ] = textureUvs.x0;\r\n\tuvs[ iuv + 1 ] = textureUvs.y0;\r\n\tuvs[ iuv + 2 ] = textureUvs.x3;\r\n\tuvs[ iuv + 3 ] = textureUvs.y3;\r\n\r\n\tuvs[ iuv + 4 ] = textureUvs.x1;\r\n\tuvs[ iuv + 5 ] = textureUvs.y1;\r\n\tuvs[ iuv + 6 ] = textureUvs.x2;\r\n\tuvs[ iuv + 7 ] = textureUvs.y2;\r\n};\r\n"]}