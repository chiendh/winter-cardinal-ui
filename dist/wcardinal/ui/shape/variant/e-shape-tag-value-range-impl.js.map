{"version":3,"file":"e-shape-tag-value-range-impl.js","sourceRoot":"","sources":["../../../../../src/main/typescript/wcardinal/ui/shape/variant/e-shape-tag-value-range-impl.ts"],"names":[],"mappings":"AAAA;;;GAGG;AAIH,OAAO,EACmE,uBAAuB,EAChG,MAAM,4BAA4B,CAAC;AAEpC;IAMC;QACC,IAAI,CAAC,KAAK,GAAG,uBAAuB,CAAC,IAAI,CAAC;QAC1C,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;QACf,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;IACd,CAAC;IAED,sBAAI,yCAAI;aAAR;YACC,OAAO,IAAI,CAAC,KAAK,CAAC;QACnB,CAAC;aAED,UAAU,IAA6B;YACtC,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAG;gBACzB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;gBAClB,IAAM,QAAM,GAAG,IAAI,CAAC,MAAM,CAAC;gBAC3B,IAAI,QAAM,IAAI,IAAI,EAAG;oBACpB,QAAM,CAAC,SAAS,GAAG,IAAI,CAAC;iBACxB;aACD;QACF,CAAC;;;OAVA;IAYD,sBAAI,yCAAI;aAAR;YACC,OAAO,IAAI,CAAC,KAAK,CAAC;QACnB,CAAC;aAED,UAAU,IAAY;YACrB,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAG;gBACzB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;gBAClB,IAAM,QAAM,GAAG,IAAI,CAAC,MAAM,CAAC;gBAC3B,IAAI,QAAM,IAAI,IAAI,EAAG;oBACpB,QAAM,CAAC,SAAS,GAAG,IAAI,CAAC;iBACxB;aACD;QACF,CAAC;;;OAVA;IAYD,sBAAI,uCAAE;aAAN;YACC,OAAO,IAAI,CAAC,GAAG,CAAC;QACjB,CAAC;aAED,UAAQ,EAAU;YACjB,IAAI,IAAI,CAAC,GAAG,KAAK,EAAE,EAAG;gBACrB,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;gBACd,IAAM,QAAM,GAAG,IAAI,CAAC,MAAM,CAAC;gBAC3B,IAAI,QAAM,IAAI,IAAI,EAAG;oBACpB,QAAM,CAAC,SAAS,GAAG,IAAI,CAAC;iBACxB;aACD;QACF,CAAC;;;OAVA;IAYD,qCAAG,GAAH,UAAK,IAAoB,EAAE,EAAkB;QAC5C,IAAI,MAAM,GAAG,KAAK,CAAC;QACnB,IAAI,IAAI,KAAK,SAAS,IAAI,EAAE,KAAK,SAAS,EAAG;YAC5C,IAAI,IAAI,KAAK,IAAI,IAAI,EAAE,KAAK,IAAI,EAAG;gBAClC,IAAM,IAAI,GAAG,CAAC,IAAI,CAAC,KAAK,GAAG,uBAAuB,CAAC,IAAI,CAAC,GAAG,uBAAuB,CAAC,EAAE,CAAC;gBACtF,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,IAAI,IAAI,CAAC,GAAG,KAAK,EAAE,EAAG;oBACnE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;oBAClB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;oBAClB,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;oBACd,MAAM,GAAG,IAAI,CAAC;iBACd;aACD;iBAAM,IAAI,IAAI,KAAK,IAAI,EAAG;gBAC1B,IAAM,IAAI,GAAG,CAAC,IAAI,CAAC,KAAK,GAAG,uBAAuB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,uBAAuB,CAAC,EAAE,CAAC,CAAC;gBACzF,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAG;oBAChD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;oBAClB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;oBAClB,MAAM,GAAG,IAAI,CAAC;iBACd;aACD;iBAAM,IAAI,EAAE,KAAK,IAAI,EAAG;gBACxB,IAAM,IAAI,GAAG,CAAC,IAAI,CAAC,KAAK,GAAG,uBAAuB,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;gBACzF,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAG;oBAChD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;oBAClB,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;oBACd,MAAM,GAAG,IAAI,CAAC;iBACd;aACD;iBAAM;gBACN,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,uBAAuB,CAAC,EAAE,GAAG,uBAAuB,CAAC,IAAI,CAAC,CAAC,CAAC;gBACzF,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAG;oBACzB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;oBAClB,MAAM,GAAG,IAAI,CAAC;iBACd;aACD;SACD;aAAM,IAAI,IAAI,KAAK,SAAS,EAAG;YAC/B,IAAI,IAAI,KAAK,IAAI,EAAG;gBACnB,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,GAAG,uBAAuB,CAAC,IAAI,CAAC;gBACvD,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAG;oBAChD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;oBAClB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;oBAClB,MAAM,GAAG,IAAI,CAAC;iBACd;aACD;iBAAM;gBACN,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;gBAC1D,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAG;oBACzB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;oBAClB,MAAM,GAAG,IAAI,CAAC;iBACd;aACD;SACD;aAAM,IAAI,EAAE,KAAK,SAAS,EAAG;YAC7B,IAAI,EAAE,KAAK,IAAI,EAAG;gBACjB,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,GAAG,uBAAuB,CAAC,EAAE,CAAC;gBACrD,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,IAAI,IAAI,CAAC,GAAG,KAAK,EAAE,EAAG;oBAC5C,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;oBAClB,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;oBACd,MAAM,GAAG,IAAI,CAAC;iBACd;aACD;iBAAM;gBACN,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,uBAAuB,CAAC,EAAE,CAAC,CAAC;gBACxD,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAG;oBACzB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;oBAClB,MAAM,GAAG,IAAI,CAAC;iBACd;aACD;SACD;QAED,IAAI,MAAM,EAAG;YACZ,IAAM,QAAM,GAAG,IAAI,CAAC,MAAM,CAAC;YAC3B,IAAI,QAAM,IAAI,IAAI,EAAG;gBACpB,QAAM,CAAC,SAAS,GAAG,IAAI,CAAC;aACxB;SACD;QAED,OAAO,MAAM,CAAC;IACf,CAAC;IAED,2CAAS,GAAT,UAAW,KAAa;QACvB,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC;QACxB,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC;QACxB,IAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QACpB,QAAQ,IAAI,EAAG;YACf,KAAK,uBAAuB,CAAC,OAAO;gBACnC,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,IAAI,CAAC,CAAC;YACrC,KAAK,uBAAuB,CAAC,IAAI;gBAChC,OAAO,KAAK,GAAG,IAAI,CAAC;YACrB,KAAK,uBAAuB,CAAC,EAAE;gBAC9B,OAAO,EAAE,GAAG,KAAK,CAAC;YACnB,KAAK,uBAAuB,CAAC,IAAI,CAAC;YAClC;gBACC,OAAO,KAAK,CAAC;SACb;IACF,CAAC;IAED,0CAAQ,GAAR,UAAU,MAA+B;QACxC,OAAO,CACN,IAAI,CAAC,KAAK,KAAK,MAAM,CAAC,IAAI;YAC1B,IAAI,CAAC,KAAK,KAAK,MAAM,CAAC,IAAI;YAC1B,IAAI,CAAC,GAAG,KAAK,MAAM,CAAC,EAAE,CACtB,CAAC;IACH,CAAC;IAED,sCAAI,GAAJ,UAAM,MAA+B;QACpC,OAAO,IAAI,CAAC,KAAK,CAAE,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC,EAAE,CAAE,CAAC;IAC1D,CAAC;IAES,uCAAK,GAAf,UAAiB,IAA6B,EAAE,IAAY,EAAE,EAAU;QACvE,IAAI,SAAS,GAAG,KAAK,CAAC;QAEtB,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAG;YACzB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;YAClB,SAAS,GAAG,IAAI,CAAC;SACjB;QAED,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAG;YACzB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;YAClB,SAAS,GAAG,IAAI,CAAC;SACjB;QAED,IAAI,IAAI,CAAC,GAAG,KAAK,EAAE,EAAG;YACrB,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;YACd,SAAS,GAAG,IAAI,CAAC;SACjB;QAED,IAAI,SAAS,EAAG;YACf,IAAM,QAAM,GAAG,IAAI,CAAC,MAAM,CAAC;YAC3B,IAAI,QAAM,IAAI,IAAI,EAAG;gBACpB,QAAM,CAAC,SAAS,GAAG,IAAI,CAAC;aACxB;SACD;QAED,OAAO,IAAI,CAAC;IACb,CAAC;IAED,0CAAQ,GAAR;QACC,OAAO;YACN,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,EAAE,EAAE,IAAI,CAAC,EAAE;SACX,CAAC;IACH,CAAC;IAED,2CAAS,GAAT,UAAW,OAA2C;QACrD,IAAM,UAAU,GAAG,MAAI,IAAI,CAAC,KAAK,SAAI,IAAI,CAAC,KAAK,SAAI,IAAI,CAAC,GAAG,MAAG,CAAC;QAC/D,OAAO,OAAO,CAAC,GAAG,CAAE,UAAU,CAAE,CAAC;IAClC,CAAC;IAED,6CAAW,GAAX,UAAa,MAAc,EAAE,OAA6C;QACzE,IAAM,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;QACpC,IAAI,CAAC,IAAI,MAAM,IAAI,MAAM,GAAG,SAAS,CAAC,MAAM,EAAG;YAC9C,IAAM,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,GAAG,CAAE,MAAM,CAAE,CAAC;YAC5C,IAAI,MAAM,IAAI,IAAI,EAAG;gBACpB,IAAI,CAAC,KAAK,CACT,MAAM,CAAE,CAAC,CAAE,EACX,MAAM,CAAE,CAAC,CAAE,EACX,MAAM,CAAE,CAAC,CAAE,CACX,CAAC;aACF;iBAAM;gBACN,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAE,SAAS,CAAE,MAAM,CAAE,CAAE,CAAC;gBACvD,OAAO,CAAC,MAAM,CAAC,GAAG,CAAE,MAAM,EAAE,YAAY,CAAE,CAAC;gBAC3C,IAAI,CAAC,KAAK,CACT,YAAY,CAAE,CAAC,CAAE,EACjB,YAAY,CAAE,CAAC,CAAE,EACjB,YAAY,CAAE,CAAC,CAAE,CACjB,CAAC;aACF;SACD;IACF,CAAC;IACF,8BAAC;AAAD,CAAC,AA3ND,IA2NC","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\r\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\r\nimport {\r\n\tEShapeTagValueRange, EShapeTagValueRangeLike, EShapeTagValueRangeParent, EShapeTagValueRangeType\r\n} from \"../e-shape-tag-value-range\";\r\n\r\nexport class EShapeTagValueRangeImpl implements EShapeTagValueRange {\r\n\tprotected _type: EShapeTagValueRangeType;\r\n\tprotected _from: number;\r\n\tprotected _to: number;\r\n\tparent?: EShapeTagValueRangeParent;\r\n\r\n\tconstructor() {\r\n\t\tthis._type = EShapeTagValueRangeType.NONE;\r\n\t\tthis._from = 0;\r\n\t\tthis._to = 1;\r\n\t}\r\n\r\n\tget type(): EShapeTagValueRangeType {\r\n\t\treturn this._type;\r\n\t}\r\n\r\n\tset type( type: EShapeTagValueRangeType ) {\r\n\t\tif( this._type !== type ) {\r\n\t\t\tthis._type = type;\r\n\t\t\tconst parent = this.parent;\r\n\t\t\tif( parent != null ) {\r\n\t\t\t\tparent.isChanged = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget from(): number {\r\n\t\treturn this._from;\r\n\t}\r\n\r\n\tset from( from: number ) {\r\n\t\tif( this._from !== from ) {\r\n\t\t\tthis._from = from;\r\n\t\t\tconst parent = this.parent;\r\n\t\t\tif( parent != null ) {\r\n\t\t\t\tparent.isChanged = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget to(): number {\r\n\t\treturn this._to;\r\n\t}\r\n\r\n\tset to( to: number ) {\r\n\t\tif( this._to !== to ) {\r\n\t\t\tthis._to = to;\r\n\t\t\tconst parent = this.parent;\r\n\t\t\tif( parent != null ) {\r\n\t\t\t\tparent.isChanged = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tset( from?: number | null, to?: number | null ): boolean {\r\n\t\tlet result = false;\r\n\t\tif( from !== undefined && to !== undefined ) {\r\n\t\t\tif( from !== null && to !== null ) {\r\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.FROM) | EShapeTagValueRangeType.TO;\r\n\t\t\t\tif( this._type !== type || this._from !== from || this._to !== to ) {\r\n\t\t\t\t\tthis._type = type;\r\n\t\t\t\t\tthis._from = from;\r\n\t\t\t\t\tthis._to = to;\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t} else if( from !== null ) {\r\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.FROM) & (~EShapeTagValueRangeType.TO);\r\n\t\t\t\tif( this._type !== type || this._from !== from ) {\r\n\t\t\t\t\tthis._type = type;\r\n\t\t\t\t\tthis._from = from;\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t} else if( to !== null ) {\r\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.TO) & (~EShapeTagValueRangeType.FROM);\r\n\t\t\t\tif( this._type !== type || this._from !== from ) {\r\n\t\t\t\t\tthis._type = type;\r\n\t\t\t\t\tthis._to = to;\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst type = this._type & (~(EShapeTagValueRangeType.TO | EShapeTagValueRangeType.FROM));\r\n\t\t\t\tif( this._type !== type ) {\r\n\t\t\t\t\tthis._type = type;\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if( from !== undefined ) {\r\n\t\t\tif( from !== null ) {\r\n\t\t\t\tconst type = this._type | EShapeTagValueRangeType.FROM;\r\n\t\t\t\tif( this._type !== type || this._from !== from ) {\r\n\t\t\t\t\tthis._type = type;\r\n\t\t\t\t\tthis._from = from;\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst type = this._type & (~EShapeTagValueRangeType.FROM);\r\n\t\t\t\tif( this._type !== type ) {\r\n\t\t\t\t\tthis._type = type;\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if( to !== undefined ) {\r\n\t\t\tif( to !== null ) {\r\n\t\t\t\tconst type = this._type | EShapeTagValueRangeType.TO;\r\n\t\t\t\tif( this._type !== type || this._to !== to ) {\r\n\t\t\t\t\tthis._type = type;\r\n\t\t\t\t\tthis._to = to;\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst type = this._type & (~EShapeTagValueRangeType.TO);\r\n\t\t\t\tif( this._type !== type ) {\r\n\t\t\t\t\tthis._type = type;\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif( result ) {\r\n\t\t\tconst parent = this.parent;\r\n\t\t\tif( parent != null ) {\r\n\t\t\t\tparent.isChanged = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tnormalize( value: number ): number {\r\n\t\tconst type = this._type;\r\n\t\tconst from = this._from;\r\n\t\tconst to = this._to;\r\n\t\tswitch( type ) {\r\n\t\tcase EShapeTagValueRangeType.FROM_TO:\r\n\t\t\treturn (value - from) / (to - from);\r\n\t\tcase EShapeTagValueRangeType.FROM:\r\n\t\t\treturn value - from;\r\n\t\tcase EShapeTagValueRangeType.TO:\r\n\t\t\treturn to - value;\r\n\t\tcase EShapeTagValueRangeType.NONE:\r\n\t\tdefault:\r\n\t\t\treturn value;\r\n\t\t}\r\n\t}\r\n\r\n\tisEquals( target: EShapeTagValueRangeLike ): boolean {\r\n\t\treturn (\r\n\t\t\tthis._type === target.type &&\r\n\t\t\tthis._from === target.from &&\r\n\t\t\tthis._to === target.to\r\n\t\t);\r\n\t}\r\n\r\n\tcopy( target: EShapeTagValueRangeLike ): this {\r\n\t\treturn this.copy_( target.type, target.from, target.to );\r\n\t}\r\n\r\n\tprotected copy_( type: EShapeTagValueRangeType, from: number, to: number ): this {\r\n\t\tlet isChanged = false;\r\n\r\n\t\tif( this._type !== type ) {\r\n\t\t\tthis._type = type;\r\n\t\t\tisChanged = true;\r\n\t\t}\r\n\r\n\t\tif( this._from !== from ) {\r\n\t\t\tthis._from = from;\r\n\t\t\tisChanged = true;\r\n\t\t}\r\n\r\n\t\tif( this._to !== to ) {\r\n\t\t\tthis._to = to;\r\n\t\t\tisChanged = true;\r\n\t\t}\r\n\r\n\t\tif( isChanged ) {\r\n\t\t\tconst parent = this.parent;\r\n\t\t\tif( parent != null ) {\r\n\t\t\t\tparent.isChanged = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\ttoObject(): EShapeTagValueRangeLike {\r\n\t\treturn {\r\n\t\t\ttype: this.type,\r\n\t\t\tfrom: this.from,\r\n\t\t\tto: this.to\r\n\t\t};\r\n\t}\r\n\r\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\r\n\t\tconst serialized = `[${this._type},${this._from},${this._to}]`;\r\n\t\treturn manager.add( serialized );\r\n\t}\r\n\r\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\r\n\t\tconst resources = manager.resources;\r\n\t\tif( 0 <= target && target < resources.length ) {\r\n\t\t\tconst parsed = manager.ranges.get( target );\r\n\t\t\tif( parsed != null ) {\r\n\t\t\t\tthis.copy_(\r\n\t\t\t\t\tparsed[ 0 ],\r\n\t\t\t\t\tparsed[ 1 ],\r\n\t\t\t\t\tparsed[ 2 ]\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\r\n\t\t\t\tmanager.ranges.set( target, deserialized );\r\n\t\t\t\tthis.copy_(\r\n\t\t\t\t\tdeserialized[ 0 ],\r\n\t\t\t\t\tdeserialized[ 1 ],\r\n\t\t\t\t\tdeserialized[ 2 ]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n"]}