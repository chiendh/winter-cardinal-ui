{"version":3,"file":"e-shape-group-size-editor.js","sourceRoot":"","sources":["../../../../../src/main/typescript/wcardinal/ui/shape/variant/e-shape-group-size-editor.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { IPoint, Point, Rectangle } from \"pixi.js\";\r\nimport { EShape } from \"../e-shape\";\r\nimport { EShapeLayout } from \"../e-shape-layout\";\r\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\r\nimport { EShapeGroupSizeLayout } from \"./e-shape-group-size-layout\";\r\nimport { EShapeGroupSizeParent } from \"./e-shape-group-size-parent\";\r\n\r\nexport class EShapeGroupSizeEditor implements EShapeGroupSize {\r\n\tprotected _parent: EShapeGroupSizeParent;\r\n\tprotected _size: Point;\r\n\tprotected _layouts: EShapeLayout[];\r\n\tprotected _workPoint: Point = new Point();\r\n\tprotected _workRectForCalcRect: Rectangle = new Rectangle();\r\n\tprotected _workRectForFit: Rectangle = new Rectangle();\r\n\r\n\tconstructor( parent: EShapeGroupSizeParent, x: number, y: number ) {\r\n\t\tthis._parent = parent;\r\n\t\tthis._layouts = [];\r\n\t\tthis._size = new Point( x, y );\r\n\t}\r\n\r\n\tinit(): void {\r\n\t\t// DO NOTHING\r\n\t}\r\n\r\n\tget x(): number {\r\n\t\treturn this._size.x;\r\n\t}\r\n\r\n\tset x( x: number ) {\r\n\t\tconst size = this._size;\r\n\t\tif( size.x !== x ) {\r\n\t\t\tconst ox = size.x;\r\n\t\t\tsize.x = x;\r\n\t\t\tthis.onChange( ox, size.y );\r\n\t\t}\r\n\t}\r\n\r\n\tget y(): number {\r\n\t\treturn this._size.y;\r\n\t}\r\n\r\n\tset y( y: number ) {\r\n\t\tconst size = this._size;\r\n\t\tif( size.y !== y ) {\r\n\t\t\tconst oy = size.y;\r\n\t\t\tsize.y = y;\r\n\t\t\tthis.onChange( size.x, oy );\r\n\t\t}\r\n\t}\r\n\r\n\tset( x?: number, y?: number ): this {\r\n\t\tlet isChanged = false;\r\n\t\tconst size = this._size;\r\n\t\tconst ox = size.x;\r\n\t\tconst oy = size.y;\r\n\t\tif( x != null && ox !== x ) {\r\n\t\t\tisChanged = true;\r\n\t\t\tsize.x = x;\r\n\t\t}\r\n\t\tif( y != null && oy !== y ) {\r\n\t\t\tisChanged = true;\r\n\t\t\tsize.y = y;\r\n\t\t}\r\n\t\tif( isChanged ) {\r\n\t\t\tthis.onChange( ox, oy );\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\tclone(): EShapeGroupSizeEditor {\r\n\t\tconst size = this._size;\r\n\t\treturn new EShapeGroupSizeEditor( this._parent, size.x, size.y );\r\n\t}\r\n\r\n\tcopy(): void {\r\n\t\t// DO NOTHING\r\n\t}\r\n\r\n\tcopyFrom( point: IPoint ): this {\r\n\t\tconst x = point.x;\r\n\t\tconst y = point.y;\r\n\t\tconst size = this._size;\r\n\t\tconst ox = size.x;\r\n\t\tconst oy = size.y;\r\n\t\tif( ox !== x || oy !== y ) {\r\n\t\t\tsize.x = x;\r\n\t\t\tsize.y = y;\r\n\t\t\tthis.onChange( ox, oy );\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\tcopyTo( point: IPoint ): IPoint {\r\n\t\treturn this._size.copyTo( point );\r\n\t}\r\n\r\n\tequals( point: IPoint ): boolean {\r\n\t\treturn this._size.equals( point );\r\n\t}\r\n\r\n\tfit(): void {\r\n\t\tconst parent = this._parent;\r\n\t\tparent.disallowOnTransformChange();\r\n\r\n\t\t// Calculate the rect\r\n\t\tconst rect = this.calcRect( this._workRectForFit );\r\n\r\n\t\t// Set size\r\n\t\tconst size = this._size;\r\n\t\tsize.set( rect.width, rect.height );\r\n\r\n\t\t// Position & Pivot\r\n\t\t// rx := rect.x\r\n\t\t// ry := rect.y\r\n\t\t//\r\n\t\t// | a c tx | | 1 0 +rx | | 1 0 -rx |   | a c tx + (a * rx + c * ry) | | 1 0 -rx |\r\n\t\t// | b d ty | | 0 1 +ry | | 0 1 -ry | = | b d ty + (b * rx + d * ry) | | 0 1 -ry |\r\n\t\t// | 0 0 1  | | 0 0  1  | | 0 0  1  |   | 0 0 1                      | | 0 0  1  |\r\n\t\t//\r\n\t\t// tx -> tx + (a * rx + c * ry) = poxition.x - (a * pivot.x + c * pivot.y)\r\n\t\t// ty -> ty + (b * rx + d * ry) = poxition.y - (b * pivot.x + d * pivot.y)\r\n\t\t// position.x -> position.x + (a * rx + c * ry) - (a * pivot.x + c * pivot.y)\r\n\t\t// position.y -> position.y + (b * rx + d * ry) - (b * pivot.x + d * pivot.y)\r\n\t\t// pivot.x -> 0\r\n\t\t// pivot.y -> 0\r\n\t\t//\r\n\t\t// a -> a', b -> b', c -> c', tx -> tx', ty -> ty'\r\n\t\t//\r\n\t\t// | a' c' tx' | | 1 0 -rx |   | a' c' tx' - (a' * rx + c' * ry) |\r\n\t\t// | b' d' ty' | | 0 1 -ry | = | b' d' ty' - (b' * rx + d' * ry) |\r\n\t\t// | 0  0  1   | | 0 0  1  |   | 0  0  1                         |\r\n\t\t//\r\n\t\t// tx' -> tx' - (a' * rx + c' * ry) = poxition.x - (a' * pivot.x + c' * pivot.y)\r\n\t\t// ty' -> ty' - (b' * rx + d' * ry) = poxition.y - (b' * pivot.x + d' * pivot.y)\r\n\t\t// pivot.x -> pivot.x + rx\r\n\t\t// pivot.y -> pivot.y + ry\r\n\t\tparent.updateTransform();\r\n\t\tconst transform = parent.transform;\r\n\t\tconst x = rect.x + rect.width * 0.5;\r\n\t\tconst y = rect.y + rect.height * 0.5;\r\n\t\tconst position = transform.position;\r\n\t\tconst localTransform = transform.localTransform;\r\n\t\tconst a = localTransform.a;\r\n\t\tconst b = localTransform.b;\r\n\t\tconst c = localTransform.c;\r\n\t\tconst d = localTransform.d;\r\n\t\tconst pivot = transform.pivot;\r\n\t\tposition.set(\r\n\t\t\tposition.x + (a * x + c * y) - (a * pivot.x + c * pivot.y),\r\n\t\t\tposition.y + (b * x + d * y) - (b * pivot.x + d * pivot.y)\r\n\t\t);\r\n\t\tpivot.set( x, y );\r\n\r\n\t\t// Reset the data\r\n\t\tthis.reset( parent.children, this._layouts, size );\r\n\r\n\t\t//\r\n\t\tparent.allowOnTransformChange( true );\r\n\t}\r\n\r\n\tprotected reset( children: EShape[], layouts: EShapeLayout[], size: IPoint ): void {\r\n\t\tfor( let i = 0, imax = Math.min( layouts.length, children.length ); i < imax; ++i ) {\r\n\t\t\tconst child = children[ i ];\r\n\t\t\tconst layout = layouts[ i ];\r\n\t\t\tif( layout.isCompatible( child ) ) {\r\n\t\t\t\tlayout.reset( child, size.x, size.y );\r\n\t\t\t} else {\r\n\t\t\t\tlayouts.length = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif( children.length < layouts.length ) {\r\n\t\t\tlayouts.length = children.length;\r\n\t\t}\r\n\t}\r\n\r\n\tcalcRect( result: Rectangle ): Rectangle {\r\n\t\tconst parent = this._parent;\r\n\t\tconst children = parent.children;\r\n\t\tif( children.length <= 0 ) {\r\n\t\t\tresult.x = 0;\r\n\t\t\tresult.y = 0;\r\n\t\t\tresult.width = 0;\r\n\t\t\tresult.height = 0;\r\n\t\t} else {\r\n\t\t\tconst workPoint = this._workPoint;\r\n\t\t\tconst workRect = this._workRectForCalcRect;\r\n\t\t\tchildren[ 0 ].getBoundsLocal( workPoint, false, result );\r\n\t\t\tfor( let i = 1, imax = children.length; i < imax; ++i ) {\r\n\t\t\t\tconst child = children[ i ];\r\n\t\t\t\tchild.getBoundsLocal( workPoint, false, workRect );\r\n\t\t\t\tresult.enlarge( workRect );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected onChange( ox: number, oy: number ): void {\r\n\t\tconst parent = this._parent;\r\n\t\tconst size = this._size;\r\n\t\tconst pivot = parent.transform.pivot;\r\n\t\tthis.onChange_( parent.children, this._layouts, size.x, size.y, pivot.x, pivot.y, ox, oy );\r\n\t\tparent.onSizeChange();\r\n\t}\r\n\r\n\tprotected onChange_(\r\n\t\tchildren: EShape[],\r\n\t\tlayouts: EShapeLayout[],\r\n\t\tsx: number, sy: number,\r\n\t\tpx: number, py: number,\r\n\t\tox: number, oy: number\r\n\t): void {\r\n\t\tfor( let i = 0, imax = Math.min( layouts.length, children.length ); i < imax; ++i ) {\r\n\t\t\tconst child = children[ i ];\r\n\t\t\tconst layout = layouts[ i ];\r\n\t\t\tif( layout.isCompatible( child ) ) {\r\n\t\t\t\tlayout.update( child, sx, sy, px, py );\r\n\t\t\t} else {\r\n\t\t\t\tlayouts.length = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor( let i = layouts.length, imax = children.length; i < imax; ++i ) {\r\n\t\t\tconst child = children[ i ];\r\n\t\t\tconst layout = this.newLayout( child, ox, oy );\r\n\t\t\tlayout.update( child, sx, sy, px, py );\r\n\t\t\tlayouts.push( layout );\r\n\t\t}\r\n\t\tif( layouts.length !== children.length ) {\r\n\t\t\tlayouts.length = children.length;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected newLayout( shape: EShape, ox: number, oy: number ): EShapeLayout {\r\n\t\treturn shape.layout || new EShapeGroupSizeLayout( shape, ox, oy );\r\n\t}\r\n}\r\n"]}