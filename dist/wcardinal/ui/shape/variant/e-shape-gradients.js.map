{"version":3,"file":"e-shape-gradients.js","sourceRoot":"","sources":["../../../../../src/main/typescript/wcardinal/ui/shape/variant/e-shape-gradients.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { UtilRgb } from \"../../util/util-rgb\";\r\nimport { EShapeGradientLike, EShapeGradientPointLike } from \"../e-shape-gradient\";\r\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\r\n\r\nexport class EShapeGradients {\r\n\tstatic serializeGradient( gradient: EShapeGradientLike ): string {\r\n\t\tconst points = gradient.points;\r\n\t\tlet result = `[${gradient.direction}`;\r\n\t\tfor( let i = 0, imax = points.length, j = 1; i < imax; i += 1, j += 3 ) {\r\n\t\t\tconst point = points[ i ];\r\n\t\t\tresult += `,${point.color},${point.alpha},${point.position}`;\r\n\t\t}\r\n\t\tresult += \"]\";\r\n\t\treturn result;\r\n\t}\r\n\r\n\tstatic parseGradient( target: string ): number[] | null {\r\n\t\ttry {\r\n\t\t\treturn JSON.parse( target ) as number[];\r\n\t\t} catch( e ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic deserializeGradient( target: string ): EShapeGradientLike | undefined {\r\n\t\tconst parsed = this.parseGradient( target );\r\n\t\tif( parsed == null || parsed.length < 7 ) {\r\n\t\t\treturn undefined;\r\n\t\t} else {\r\n\t\t\tconst direction = parsed[ 0 ];\r\n\t\t\tconst points: EShapeGradientPointLike[] = [];\r\n\t\t\tfor( let i = 1, imax = parsed.length; i < imax; i += 3 ) {\r\n\t\t\t\tpoints.push({\r\n\t\t\t\t\tcolor: parsed[ i + 0 ],\r\n\t\t\t\t\talpha: parsed[ i + 1 ],\r\n\t\t\t\t\tposition: parsed[ i + 2 ]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tpoints,\r\n\t\t\t\tdirection\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tstatic toGradientId( gradient: EShapeGradientLike | undefined, manager: EShapeResourceManagerSerialization ): number {\r\n\t\tif( gradient != null ) {\r\n\t\t\tif( gradient.serialized == null ) {\r\n\t\t\t\tgradient.serialized = this.serializeGradient( gradient );\r\n\t\t\t}\r\n\t\t\treturn manager.add( gradient.serialized );\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n\r\n\tstatic toGradientImageUrl( gradient: EShapeGradientLike ): string {\r\n\t\tconst direction = gradient.direction;\r\n\t\tconst points = gradient.points;\r\n\r\n\t\tlet stops = \"\";\r\n\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\r\n\t\t\tconst point = points[ i ];\r\n\t\t\tconst color = UtilRgb.toCode( point.color );\r\n\t\t\tconst alpha = point.alpha;\r\n\t\t\tconst offset = point.position * 100;\r\n\t\t\tstops += `<stop offset=\"${offset}%\" stop-color=\"#${color}\" stop-opacity=\"${alpha}\" />`;\r\n\t\t}\r\n\r\n\t\tconst radian = direction * Math.PI / 180;\r\n\t\tconst dx = 0.5 * Math.cos( radian );\r\n\t\tconst dy = -0.5 * Math.sin( radian );\r\n\r\n\t\tconst url = \"data:image/svg+xml;base64,\" + btoa(\r\n\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 32 32\">` +\r\n\t\t\t\t`<defs>` +\r\n\t\t\t\t\t`<linearGradient id=\"o2glkm3aeu2oio\" x1=\"${0.5 - dx}\" x2=\"${0.5 + dx}\" y1=\"${0.5 - dy}\" y2=\"${0.5 + dy}\">` +\r\n\t\t\t\t\t\tstops +\r\n\t\t\t\t\t`</linearGradient>` +\r\n\t\t\t\t`</defs>` +\r\n\t\t\t\t`<rect x=\"0\" y=\"0\" width=\"32\" height=\"32\" stroke=\"none\" fill=\"url(#o2glkm3aeu2oio)\" />` +\r\n\t\t\t`</svg>`\r\n\t\t);\r\n\r\n\t\treturn url;\r\n\t}\r\n}\r\n"]}