{"version":3,"file":"e-shape-line-of-triangles-uploaded.js","sourceRoot":"","sources":["../../../../../src/main/typescript/wcardinal/ui/shape/variant/e-shape-line-of-triangles-uploaded.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { EShape } from \"../e-shape\";\r\nimport { EShapeBuffer } from \"../e-shape-buffer\";\r\nimport { buildNullStep, buildNullUv, buildNullVertex } from \"./build-null\";\r\nimport {\r\n\tbuildTriangleClipping, buildTriangleIndex, buildTriangleStep, buildTriangleUv, buildTriangleVertex,\r\n\tTRIANGLE_INDEX_COUNT, TRIANGLE_VERTEX_COUNT, TRIANGLE_WORLD_SIZE\r\n} from \"./build-triangle\";\r\nimport { copyClipping } from \"./copy-clipping\";\r\nimport { copyIndex } from \"./copy-index\";\r\nimport { copyStep } from \"./copy-step\";\r\nimport { copyUvs } from \"./copy-uv\";\r\nimport { copyVertex } from \"./copy-vertex\";\r\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\r\nimport { EShapeLineOfAnyPointsImpl } from \"./e-shape-line-of-any-points-impl\";\r\nimport { EShapeLineOfAnyUploaded } from \"./e-shape-line-of-any-uploaded\";\r\n\r\nexport class EShapeLineOfTrianglesUploaded extends EShapeLineOfAnyUploaded {\r\n\tinit( shape: EShape ): this {\r\n\t\tsuper.init( shape );\r\n\r\n\t\tconst buffer = this.buffer;\r\n\t\tbuffer.updateClippings();\r\n\t\tbuffer.updateIndices();\r\n\t\tconst clippings = buffer.clippings;\r\n\t\tconst indices = buffer.indices;\r\n\t\tconst voffset = this.vertexOffset;\r\n\t\tconst ioffset = this.indexOffset;\r\n\t\tconst pointCountReserved = this.pointCountReserved;\r\n\t\tif( 0 < pointCountReserved ) {\r\n\t\t\tbuildTriangleClipping(\r\n\t\t\t\tclippings,\r\n\t\t\t\tvoffset\r\n\t\t\t);\r\n\t\t\tcopyClipping(\r\n\t\t\t\tclippings,\r\n\t\t\t\tvoffset,\r\n\t\t\t\tTRIANGLE_VERTEX_COUNT,\r\n\t\t\t\tpointCountReserved\r\n\t\t\t);\r\n\t\t\tbuildTriangleIndex(\r\n\t\t\t\tindices,\r\n\t\t\t\tvoffset,\r\n\t\t\t\tioffset\r\n\t\t\t);\r\n\t\t\tcopyIndex(\r\n\t\t\t\tindices,\r\n\t\t\t\tTRIANGLE_VERTEX_COUNT,\r\n\t\t\t\tioffset,\r\n\t\t\t\tTRIANGLE_INDEX_COUNT,\r\n\t\t\t\tpointCountReserved\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Text\r\n\t\tthis.initText();\r\n\r\n\t\tthis.update( shape );\r\n\t\treturn this;\r\n\t}\r\n\r\n\tupdate( shape: EShape ): void {\r\n\t\tconst buffer = this.buffer;\r\n\t\tconst points = shape.points;\r\n\t\tif( points instanceof EShapeLineOfAnyPointsImpl ) {\r\n\t\t\tthis.updateVertexStepAndUvs( buffer, shape, points );\r\n\t\t\tthis.updateLineOfAnyColorFill( buffer, shape, points, TRIANGLE_VERTEX_COUNT );\r\n\t\t\tthis.updateLineOfAnyColorStroke( buffer, shape, points, TRIANGLE_VERTEX_COUNT );\r\n\t\t\tthis.updateText( buffer, shape );\r\n\t\t}\r\n\t}\r\n\r\n\tprotected updateVertexStepAndUvs( buffer: EShapeBuffer, shape: EShape, points: EShapeLineOfAnyPoints ) {\r\n\t\tconst pointId = points.id;\r\n\t\tconst pointOffset = points.offset;\r\n\t\tconst pointOffsetId = pointOffset.id;\r\n\t\tconst isPointChanged = ( pointId !== this.pointId || pointOffsetId !== this.pointOffsetId );\r\n\r\n\t\tconst pointSize = points.size;\r\n\t\tconst pointSizeId = pointSize.id;\r\n\t\tconst isPointSizeChanged = ( pointSizeId !== this.pointSizeId );\r\n\r\n\t\tconst size = shape.size;\r\n\t\tconst sizeX = size.x;\r\n\t\tconst sizeY = size.y;\r\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\r\n\r\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\r\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\r\n\r\n\t\tconst stroke = shape.stroke;\r\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\r\n\t\tconst strokeAlign = stroke.align;\r\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\r\n\r\n\t\tconst texture = this.toTexture( shape );\r\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\r\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\r\n\r\n\t\tconst isVertexChanged = isPointChanged || isPointSizeChanged || isSizeChanged || isStrokeChanged;\r\n\r\n\t\tif( isVertexChanged || isTransformChanged || isTextureChanged ) {\r\n\t\t\tthis.pointId = pointId;\r\n\t\t\tthis.pointCount = points.length;\r\n\t\t\tthis.pointOffsetId = pointOffsetId;\r\n\t\t\tthis.pointSizeId = pointSizeId;\r\n\t\t\tthis.sizeX = sizeX;\r\n\t\t\tthis.sizeY = sizeY;\r\n\t\t\tthis.transformLocalId = transformLocalId;\r\n\t\t\tthis.strokeWidth = strokeWidth;\r\n\t\t\tthis.strokeAlign = strokeAlign;\r\n\r\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\r\n\t\t\t\t// Invalidate the text layout to update the text layout.\r\n\t\t\t\tthis.textSpacingHorizontal = NaN;\r\n\t\t\t}\r\n\r\n\t\t\t// Buffer\r\n\t\t\tbuffer.updateVertices();\r\n\t\t\tif( isVertexChanged || isTransformChanged ) {\r\n\t\t\t\tbuffer.updateSteps();\r\n\t\t\t}\r\n\t\t\tif( isVertexChanged || isTextureChanged ) {\r\n\t\t\t\tbuffer.updateUvs();\r\n\t\t\t}\r\n\r\n\t\t\tconst pointCount = this.pointCount;\r\n\t\t\tconst pointsValues = points.values;\r\n\t\t\tconst voffset = this.vertexOffset;\r\n\t\t\tconst vertices = buffer.vertices;\r\n\t\t\tconst steps = buffer.steps;\r\n\t\t\tconst clippings = buffer.clippings;\r\n\t\t\tconst uvs = buffer.uvs;\r\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\r\n\t\t\tconst internalTransform = shape.transform.internalTransform;\r\n\t\t\tconst antialiasWeight = this.antialiasWeight;\r\n\t\t\tif( 0 < pointCount && pointSize.isStaticX() && pointSize.isStaticY() ) {\r\n\t\t\t\tconst pointSizeX = pointSize.getX( 0 );\r\n\t\t\t\tconst pointSizeY = pointSize.getY( 0 );\r\n\r\n\t\t\t\tbuildTriangleVertex(\r\n\t\t\t\t\tvertices,\r\n\t\t\t\t\tvoffset,\r\n\t\t\t\t\t0, 0,\r\n\t\t\t\t\tpointSizeX, pointSizeY,\r\n\t\t\t\t\tstrokeAlign,\r\n\t\t\t\t\tstrokeWidth,\r\n\t\t\t\t\tinternalTransform,\r\n\t\t\t\t\tTRIANGLE_WORLD_SIZE\r\n\t\t\t\t);\r\n\t\t\t\tcopyVertex(\r\n\t\t\t\t\tvertices,\r\n\t\t\t\t\tinternalTransform,\r\n\t\t\t\t\tvoffset, TRIANGLE_VERTEX_COUNT,\r\n\t\t\t\t\tpointCount, pointsValues,\r\n\t\t\t\t\tpointOffset\r\n\t\t\t\t);\r\n\t\t\t\tif( isVertexChanged || isTransformChanged ) {\r\n\t\t\t\t\tbuildTriangleStep(\r\n\t\t\t\t\t\tsteps,\r\n\t\t\t\t\t\tclippings,\r\n\t\t\t\t\t\tvoffset,\r\n\t\t\t\t\t\tTRIANGLE_VERTEX_COUNT,\r\n\t\t\t\t\t\tstrokeWidth,\r\n\t\t\t\t\t\tantialiasWeight,\r\n\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\r\n\t\t\t\t\t);\r\n\t\t\t\t\tcopyStep(\r\n\t\t\t\t\t\tsteps,\r\n\t\t\t\t\t\tvoffset, TRIANGLE_VERTEX_COUNT,\r\n\t\t\t\t\t\tpointCount\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif( isVertexChanged || isTextureChanged ) {\r\n\t\t\t\t\tbuildTriangleUv(\r\n\t\t\t\t\t\tuvs,\r\n\t\t\t\t\t\ttextureUvs,\r\n\t\t\t\t\t\tvoffset,\r\n\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\r\n\t\t\t\t\t);\r\n\t\t\t\t\tcopyUvs(\r\n\t\t\t\t\t\tuvs,\r\n\t\t\t\t\t\tvoffset,\r\n\t\t\t\t\t\tTRIANGLE_VERTEX_COUNT,\r\n\t\t\t\t\t\tpointCount\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor( let i = 0; i < pointCount; ++i ) {\r\n\t\t\t\t\tconst ip = i << 1;\r\n\t\t\t\t\tconst px = pointsValues[ ip     ] + pointOffset.getX( i );\r\n\t\t\t\t\tconst py = pointsValues[ ip + 1 ] + pointOffset.getY( i );\r\n\t\t\t\t\tconst pointSizeX = pointSize.getX( i );\r\n\t\t\t\t\tconst pointSizeY = pointSize.getY( i );\r\n\t\t\t\t\tconst iv = voffset + i * TRIANGLE_VERTEX_COUNT;\r\n\r\n\t\t\t\t\tbuildTriangleVertex(\r\n\t\t\t\t\t\tvertices,\r\n\t\t\t\t\t\tiv,\r\n\t\t\t\t\t\tpx, py,\r\n\t\t\t\t\t\tpointSizeX, pointSizeY,\r\n\t\t\t\t\t\tstrokeAlign,\r\n\t\t\t\t\t\tstrokeWidth,\r\n\t\t\t\t\t\tinternalTransform,\r\n\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif( isVertexChanged || isTransformChanged ) {\r\n\t\t\t\t\t\tbuildTriangleStep(\r\n\t\t\t\t\t\t\tsteps,\r\n\t\t\t\t\t\t\tclippings,\r\n\t\t\t\t\t\t\tiv,\r\n\t\t\t\t\t\t\tTRIANGLE_VERTEX_COUNT,\r\n\t\t\t\t\t\t\tstrokeWidth,\r\n\t\t\t\t\t\t\tantialiasWeight,\r\n\t\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif( isVertexChanged || isTextureChanged ) {\r\n\t\t\t\t\t\tbuildTriangleUv(\r\n\t\t\t\t\t\t\tuvs,\r\n\t\t\t\t\t\t\ttextureUvs,\r\n\t\t\t\t\t\t\tiv,\r\n\t\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Fill the rest\r\n\t\t\tconst pointCountReserved = this.pointCountReserved;\r\n\t\t\tconst voffsetReserved = voffset + pointCount * TRIANGLE_VERTEX_COUNT;\r\n\t\t\tconst vcountReserved = TRIANGLE_VERTEX_COUNT * (pointCountReserved - pointCount);\r\n\t\t\tbuildNullVertex(\r\n\t\t\t\tvertices,\r\n\t\t\t\tvoffsetReserved,\r\n\t\t\t\tvcountReserved\r\n\t\t\t);\r\n\t\t\tbuildNullStep(\r\n\t\t\t\tsteps,\r\n\t\t\t\tvoffsetReserved,\r\n\t\t\t\tvcountReserved\r\n\t\t\t);\r\n\t\t\tbuildNullUv(\r\n\t\t\t\tuvs,\r\n\t\t\t\tvoffsetReserved,\r\n\t\t\t\tvcountReserved\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n}\r\n"]}