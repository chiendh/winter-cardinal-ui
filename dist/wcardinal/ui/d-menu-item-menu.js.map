{"version":3,"file":"d-menu-item-menu.js","sourceRoot":"","sources":["../../../src/main/typescript/wcardinal/ui/d-menu-item-menu.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { DisplayObject, interaction } from \"pixi.js\";\r\nimport { DMenu, DMenuOptions } from \"./d-menu\";\r\nimport { DMenuAlign } from \"./d-menu-align\";\r\nimport { Closeable } from \"./d-menu-context\";\r\nimport { DMenuItem, DMenuItemOptions, DThemeMenuItem } from \"./d-menu-item\";\r\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\r\nimport { DMenus } from \"./d-menus\";\r\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\r\n\r\nexport interface DMenuItemMenuOptions<\r\n\tVALUE = unknown,\r\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu\r\n> extends DMenuItemOptions<VALUE, THEME> {\r\n\tmenu: DMenuOptions<VALUE> | DMenu<VALUE>;\r\n}\r\n\r\nexport interface DThemeMenuItemMenu extends DThemeMenuItem {\r\n\r\n}\r\n\r\nexport class DMenuItemMenu<\r\n\tVALUE = unknown,\r\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\r\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\r\n> extends DMenuItem<VALUE, THEME, OPTIONS> {\r\n\tprotected _menu!: DMenu<VALUE>;\r\n\r\n\tconstructor( options: OPTIONS ) {\r\n\t\tsuper( options );\r\n\t}\r\n\r\n\tprotected init( options: OPTIONS ) {\r\n\t\tsuper.init( options );\r\n\r\n\t\tUtilPointerEvent.onClick( this, (): void => {\r\n\t\t\tif( this.isActionable() ) {\r\n\t\t\t\tthis.open();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.initHover( options );\r\n\r\n\t\tconst menu = this.toMenu( options );\r\n\t\tthis._menu = menu;\r\n\t\tmenu.on( \"select\", ( value: VALUE, item: DMenuItem<VALUE>, closeable: Closeable ): void => {\r\n\t\t\tthis.onMenuSelect( value, item, closeable );\r\n\t\t});\r\n\t}\r\n\r\n\tprotected initHover( options: OPTIONS ): void {\r\n\t\tthis.on( UtilPointerEvent.over, (): void => {\r\n\t\t\tif( this.isActionable() ) {\r\n\t\t\t\tthis.open();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprotected toMenu( options: OPTIONS ): DMenu<VALUE> {\r\n\t\tconst menu = options.menu;\r\n\t\tif( menu instanceof DisplayObject ) {\r\n\t\t\treturn menu;\r\n\t\t}\r\n\t\treturn this.newMenu( menu );\r\n\t}\r\n\r\n\tprotected newMenu( options: DMenuOptions<VALUE> ): DMenu<VALUE> {\r\n\t\treturn DMenus.newMenu( options );\r\n\t}\r\n\r\n\tget menu(): DMenu<VALUE> {\r\n\t\treturn this._menu;\r\n\t}\r\n\r\n\tprotected getType(): string {\r\n\t\treturn \"DMenuItemMenu\";\r\n\t}\r\n\r\n\topen(): void {\r\n\t\tconst menu = this._menu;\r\n\t\tif( menu.isHidden() ) {\r\n\t\t\tthis.onOpen( menu );\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onOpen( menu: DMenu<VALUE> ): void {\r\n\t\tconst context = this.getContext();\r\n\t\tif( context != null ) {\r\n\t\t\tmenu.open( this, this.getCloseable(), context );\r\n\t\t}\r\n\t}\r\n\r\n\tclose(): void {\r\n\t\tthis._menu.close();\r\n\t}\r\n\r\n\ttoggle(): void {\r\n\t\tconst menu = this._menu;\r\n\t\tif( menu.isHidden() ) {\r\n\t\t\tthis.onOpen( menu );\r\n\t\t} else {\r\n\t\t\tmenu.close();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\r\n\t\tthis.open();\r\n\t\tsuper.onSelect( e );\r\n\t}\r\n\r\n\tprotected onMenuSelect( value: VALUE, item: DMenuItem<VALUE>, closeable: Closeable ): void {\r\n\t\tconst next = this.getCloseable();\r\n\t\tif( next != null ) {\r\n\t\t\tnext.emit( \"select\", value, item, closeable );\r\n\t\t}\r\n\t}\r\n\r\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemMenuOptions<VALUE> {\r\n\t\treturn \"menu\" in options;\r\n\t}\r\n\r\n\tstatic toSubMenuOptions<VALUE>( options: DMenuItemMenuOptions<VALUE>, sticky: boolean ): DMenuItemMenuOptions<VALUE> {\r\n\t\tconst menu = options.menu;\r\n\t\tif( ! (menu instanceof DisplayObject) ) {\r\n\t\t\tif( menu.sticky == null ) {\r\n\t\t\t\tmenu.sticky = sticky;\r\n\t\t\t}\r\n\t\t\tif( menu.align == null ) {\r\n\t\t\t\tmenu.align = DMenuAlign.RIGHT;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn options;\r\n\t}\r\n}\r\n"]}