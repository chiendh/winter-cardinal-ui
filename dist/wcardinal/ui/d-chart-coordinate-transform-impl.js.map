{"version":3,"file":"d-chart-coordinate-transform-impl.js","sourceRoot":"","sources":["../../../src/main/typescript/wcardinal/ui/d-chart-coordinate-transform-impl.ts"],"names":[],"mappings":"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","sourcesContent":["import { DChartCoordinateDirection } from \"./d-chart-coordinate\";\r\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\r\nimport { DChartCoordinateTransform, DThemeChartCoordinateTransform } from \"./d-chart-coordinate-transform\";\r\nimport { DChartCoordinateTransformMark } from \"./d-chart-coordinate-transform-mark\";\r\n\r\nexport class DChartCoordinateTransformImpl implements DChartCoordinateTransform {\r\n\tprotected _theme: DThemeChartCoordinateTransform;\r\n\tprotected _id: number;\r\n\tprotected _translate: number;\r\n\tprotected _scale: number;\r\n\tprotected _itranslate: number;\r\n\tprotected _iscale: number;\r\n\r\n\tconstructor( theme: DThemeChartCoordinateTransform ) {\r\n\t\tthis._theme = theme;\r\n\t\tthis._id = 0;\r\n\t\tthis._translate = 0;\r\n\t\tthis._scale = 1;\r\n\t\tthis._itranslate = 0;\r\n\t\tthis._iscale = 1;\r\n\t}\r\n\r\n\tget id(): number {\r\n\t\treturn this._id;\r\n\t}\r\n\r\n\tget translate(): number {\r\n\t\treturn this._translate;\r\n\t}\r\n\r\n\tset translate( translate: number ) {\r\n\t\tthis.set( translate );\r\n\t}\r\n\r\n\tget scale(): number {\r\n\t\treturn this._scale;\r\n\t}\r\n\r\n\tset scale( scale: number ) {\r\n\t\tthis.set( undefined, scale );\r\n\t}\r\n\r\n\tbind( container: DChartCoordinateContainerSub, direction: DChartCoordinateDirection ): void {\r\n\t\tthis.set( 0, direction === DChartCoordinateDirection.X ? +1 : -1 );\r\n\t}\r\n\r\n\tunbind(): void {\r\n\t\t// DO NOTHING\r\n\t}\r\n\r\n\tset( translate?: number, scale?: number ): void {\r\n\t\tlet isChanged = false;\r\n\r\n\t\tif( translate != null && this._translate !== translate ) {\r\n\t\t\tisChanged = true;\r\n\t\t\tthis._translate = translate;\r\n\t\t}\r\n\r\n\t\tif( scale != null && this._scale !== scale ) {\r\n\t\t\tisChanged = true;\r\n\t\t\tthis._scale = scale;\r\n\t\t}\r\n\r\n\t\tif( isChanged ) {\r\n\t\t\tthis._id += 1;\r\n\t\t\tthis._iscale = ( this._theme.isZero( this._scale ) ? 0 : 1 / this._scale );\r\n\t\t\tthis._itranslate = - this._translate * this._iscale;\r\n\t\t}\r\n\t}\r\n\r\n\tblend( ratio: number, mark: DChartCoordinateTransformMark ): void {\r\n\t\tconst ratioi = 1 - ratio;\r\n\t\tconst newTranslate = mark.newTranslate * ratio + mark.oldTranslate * ratioi;\r\n\t\tconst newScale = mark.newScale * ratio + mark.oldScale * ratioi;\r\n\t\tthis.set( newTranslate, newScale );\r\n\t}\r\n\r\n\tmap( value: number ): number {\r\n\t\treturn this._translate + this._scale * value;\r\n\t}\r\n\r\n\tmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\r\n\t\tconst translate = this._translate;\r\n\t\tconst scale = this._scale;\r\n\t\tfor( let i = ifrom + offset; i < iend; i += stride ) {\r\n\t\t\tvalues[ i ] = translate + scale * values[ i ];\r\n\t\t}\r\n\t}\r\n\r\n\tunmap( value: number ): number {\r\n\t\treturn this._itranslate + this._iscale * value;\r\n\t}\r\n\r\n\tunmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\r\n\t\tconst itranslate = this._itranslate;\r\n\t\tconst iscale = this._iscale;\r\n\t\tfor( let i = ifrom + offset; i < iend; i += stride ) {\r\n\t\t\tvalues[ i ] = itranslate + iscale * values[ i ];\r\n\t\t}\r\n\t}\r\n}\r\n"]}