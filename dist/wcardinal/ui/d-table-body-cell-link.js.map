{"version":3,"file":"d-table-body-cell-link.js","sourceRoot":"","sources":["../../../src/main/typescript/wcardinal/ui/d-table-body-cell-link.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { interaction } from \"pixi.js\";\r\nimport { DBaseState } from \"./d-base-state\";\r\nimport { DLink, DLinkChecker, DLinkOptions, DLinkUrlMaker, DThemeLink } from \"./d-link\";\r\nimport { DLinkMenuItemId } from \"./d-link-menu-item-id\";\r\nimport { DLinkTarget } from \"./d-link-target\";\r\nimport { DMenu, DMenuOptions } from \"./d-menu\";\r\nimport {\r\n\tDTableBodyCellButton, DTableBodyCellButtonOptions, DThemeTableBodyCellButton\r\n} from \"./d-table-body-cell-button\";\r\nimport { DTableCellState } from \"./d-table-cell-state\";\r\nimport { isString } from \"./util/is-string\";\r\n\r\nexport type DTableBodyCellLinkUrlMaker<ROW> = (\r\n\trow: ROW, rowIndex: number, columnIndex: number, link: DTableBodyCellLink<ROW>\r\n) => string | null | Promise<string | null>;\r\nexport type DTableBodyCellLinkChecker<ROW> = (\r\n\trow: ROW, rowIndex: number, columnIndex: number, link: DTableBodyCellLink<ROW>\r\n) => boolean | Promise<boolean>;\r\n\r\nexport interface DTableBodyCellLinkLinkOptions<ROW> {\r\n\turl?: string | DTableBodyCellLinkUrlMaker<ROW>;\r\n\ttarget?: DLinkTarget;\r\n\tchecker?: DTableBodyCellLinkChecker<ROW>;\r\n\tmenu?: DMenuOptions<DLinkMenuItemId> | DMenu<DLinkMenuItemId>;\r\n}\r\n\r\nexport interface DTableBodyCellLinkOptions<\r\n\tROW,\r\n\tTHEME extends DThemeTableBodyCellLink = DThemeTableBodyCellLink\r\n> extends DTableBodyCellButtonOptions<ROW, THEME> {\r\n\tlink?: DTableBodyCellLinkLinkOptions<ROW>;\r\n}\r\n\r\nexport interface DThemeTableBodyCellLink extends DThemeTableBodyCellButton, DThemeLink {\r\n\r\n}\r\n\r\nexport class DTableBodyCellLink<\r\n\tROW,\r\n\tTHEME extends DThemeTableBodyCellLink = DThemeTableBodyCellLink,\r\n\tOPTIONS extends DTableBodyCellLinkOptions<ROW, THEME> = DTableBodyCellLinkOptions<ROW, THEME>\r\n> extends DTableBodyCellButton<ROW, THEME, OPTIONS> {\r\n\tprotected _link!: DLink;\r\n\r\n\tconstructor( options: OPTIONS ) {\r\n\t\tsuper( options );\r\n\t}\r\n\r\n\tprotected toLinkOptions( options: OPTIONS ): DLinkOptions | undefined {\r\n\t\tconst link = options.link;\r\n\t\tif( link ) {\r\n\t\t\treturn {\r\n\t\t\t\turl: this.toUrl( link.url ),\r\n\t\t\t\ttarget: link.target,\r\n\t\t\t\tchecker: this.toChecker( link.checker ),\r\n\t\t\t\tmenu: link.menu\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tprotected toUrl( url?: string | DTableBodyCellLinkUrlMaker<ROW> ): string | DLinkUrlMaker | undefined {\r\n\t\tif( isString( url ) || url == null ) {\r\n\t\t\treturn url;\r\n\t\t} else {\r\n\t\t\treturn () => {\r\n\t\t\t\tconst row = this._row;\r\n\t\t\t\tif( row !== undefined ) {\r\n\t\t\t\t\treturn url( row, this._rowIndex, this._columnIndex, this );\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tprotected toChecker( checker?: DTableBodyCellLinkChecker<ROW> ): DLinkChecker | undefined {\r\n\t\tif( checker != null ) {\r\n\t\t\treturn () => {\r\n\t\t\t\tconst row = this._row;\r\n\t\t\t\tif( row !== undefined ) {\r\n\t\t\t\t\treturn checker( row, this._rowIndex, this._columnIndex, this );\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tprotected init( options: OPTIONS ): void {\r\n\t\tif( options.link && options.link.target === DLinkTarget.NEW_WINDOW ) {\r\n\t\t\toptions.state = ( options.state || DBaseState.NONE ) || DTableCellState.NEW_WINDOW;\r\n\t\t}\r\n\t\tthis._link = new DLink( this.theme, this.toLinkOptions( options ) );\r\n\t\tsuper.init( options );\r\n\t}\r\n\r\n\tprotected initOnClick( options: OPTIONS ): void {\r\n\t\tthis._link.apply( this, ( e ) => this.onActive( e ) );\r\n\t}\r\n\r\n\tget url(): string | null | Promise<string | null> {\r\n\t\treturn this._link.url;\r\n\t}\r\n\r\n\tget menu(): DMenu<DLinkMenuItemId> {\r\n\t\treturn this._link.menu;\r\n\t}\r\n\r\n\tprotected getType(): string {\r\n\t\treturn \"DTableBodyCellLink\";\r\n\t}\r\n\r\n\tprotected onActive( e: KeyboardEvent | interaction.InteractionEvent ): void {\r\n\t\tthis.emit( \"active\", this );\r\n\t\tconst row = this._row;\r\n\t\tif( row !== undefined ) {\r\n\t\t\tconst rowIndex = this._rowIndex;\r\n\t\t\tconst columnIndex = this._columnIndex;\r\n\t\t\tthis._columnData.setter( row, columnIndex, null );\r\n\t\t\tthis.emit( \"cellchange\", null, null, row, rowIndex, columnIndex, this );\r\n\t\t\tthis.open( this._link.inNewWindow( e ) );\r\n\t\t}\r\n\t}\r\n\r\n\topen( inNewWindow: boolean ): void {\r\n\t\tthis._link.open( inNewWindow );\r\n\t}\r\n}\r\n"]}