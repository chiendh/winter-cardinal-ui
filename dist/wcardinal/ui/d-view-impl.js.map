{"version":3,"file":"d-view-impl.js","sourceRoot":"","sources":["../../../src/main/typescript/wcardinal/ui/d-view-impl.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { interaction, IPoint, Point, Rectangle } from \"pixi.js\";\r\nimport { DBase } from \"./d-base\";\r\nimport { DMouseModifier } from \"./d-mouse-modifier\";\r\nimport { DMouseModifiers } from \"./d-mouse-modifiers\";\r\nimport { DThemeView, DView, DViewChecker, DViewOptions } from \"./d-view\";\r\nimport { DViewDrag } from \"./d-view-drag\";\r\nimport { DViewDragImpl } from \"./d-view-drag-impl\";\r\nimport { DViewTargetPoint, DViewToTarget } from \"./d-view-to-target\";\r\nimport { DViewTransformImpl } from \"./d-view-transform-impl\";\r\nimport { DThemes } from \"./theme/d-themes\";\r\nimport { isString } from \"./util/is-string\";\r\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\r\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\r\n\r\nexport class DViewImpl implements DView {\r\n\tprotected _parent: DBase;\r\n\tprotected _toTarget: DViewToTarget;\r\n\r\n\tprotected _zoomPoint: Point;\r\n\tprotected _zoomMin: number;\r\n\tprotected _zoomMax: number;\r\n\tprotected _zoomKeepRatio: boolean;\r\n\r\n\tprotected _isWheelZoomEnabled: boolean;\r\n\tprotected _wheelZoomSpeed: number;\r\n\tprotected _wheelZoomModifier: DMouseModifier;\r\n\tprotected _wheelZoomChecker: DViewChecker;\r\n\r\n\tprotected _isDblClickZoomEnabled: boolean;\r\n\tprotected _dblClickZoomSpeed: number;\r\n\tprotected _dblClickZoomModifier: DMouseModifier;\r\n\tprotected _dblClickZoomChecker: DViewChecker;\r\n\tprotected _dblclickZoomDuration: number;\r\n\r\n\tprotected _isWheelTranslationEnabled: boolean;\r\n\tprotected _wheelTranslationSpeed: number;\r\n\tprotected _wheelTranslationModifier: DMouseModifier;\r\n\tprotected _wheelTranslationChecker: DViewChecker;\r\n\r\n\tprotected _transform: DViewTransformImpl;\r\n\tprotected _drag: DViewDragImpl;\r\n\r\n\tprotected _workRect: Rectangle;\r\n\r\n\tconstructor( parent: DBase, toTarget: DViewToTarget, options: DViewOptions | undefined ) {\r\n\t\tthis._parent = parent;\r\n\t\tthis._toTarget = toTarget;\r\n\r\n\t\tthis._workRect = new Rectangle();\r\n\r\n\t\t// Theme\r\n\t\tconst theme = this.toTheme( options ) || this.getThemeDefault();\r\n\r\n\t\t// Zoom\r\n\t\tconst zoom = options && options.zoom;\r\n\t\tthis._zoomPoint = new Point();\r\n\t\tthis._zoomMin = zoom && zoom.min != null ? zoom.min : theme.getZoomMin();\r\n\t\tthis._zoomMax = zoom && zoom.max != null ? zoom.max : theme.getZoomMax();\r\n\t\tthis._zoomKeepRatio = zoom && zoom.keepRatio != null ? zoom.keepRatio : theme.getZoomKeepRatio();\r\n\r\n\t\t// Zoom: Wheel\r\n\t\tconst wheelZoom = zoom && zoom.wheel;\r\n\t\tthis._isWheelZoomEnabled = ( wheelZoom && wheelZoom.enable != null ?\r\n\t\t\twheelZoom.enable : theme.isWheelZoomEnabled()\r\n\t\t);\r\n\t\tthis._wheelZoomSpeed = ( wheelZoom && wheelZoom.speed != null ?\r\n\t\t\twheelZoom.speed : theme.getWheelZoomSpeed()\r\n\t\t);\r\n\t\tthis._wheelZoomModifier = ( wheelZoom && wheelZoom.modifier != null ?\r\n\t\t\t( isString( wheelZoom.modifier ) ?\r\n\t\t\t\tDMouseModifier[ wheelZoom.modifier ] : wheelZoom.modifier\r\n\t\t\t) :\r\n\t\t\ttheme.getWheelZoomModifier()\r\n\t\t);\r\n\t\tthis._wheelZoomChecker = (wheelZoom && wheelZoom.checker) || DMouseModifiers.match;\r\n\r\n\t\t// Zoom: Dbl click\r\n\t\tconst dblClickZoom = zoom && zoom.dblclick;\r\n\t\tthis._isDblClickZoomEnabled = ( dblClickZoom && dblClickZoom.enable != null ?\r\n\t\t\tdblClickZoom.enable : theme.isDblClickZoomEnabled()\r\n\t\t);\r\n\t\tthis._dblClickZoomSpeed = ( dblClickZoom && dblClickZoom.amount != null ?\r\n\t\t\tdblClickZoom.amount : theme.getDblClickZoomSpeed()\r\n\t\t);\r\n\t\tthis._dblClickZoomModifier = ( dblClickZoom && dblClickZoom.modifier != null ?\r\n\t\t\t( isString( dblClickZoom.modifier ) ?\r\n\t\t\t\tDMouseModifier[ dblClickZoom.modifier ] : dblClickZoom.modifier\r\n\t\t\t) :\r\n\t\t\ttheme.getDblClickZoomModifier()\r\n\t\t);\r\n\t\tthis._dblClickZoomChecker = ( dblClickZoom && dblClickZoom.checker ) || DMouseModifiers.match;\r\n\t\tthis._dblclickZoomDuration = ( dblClickZoom && dblClickZoom.duration != null ?\r\n\t\t\tdblClickZoom.duration : theme.getDblClickZoomDuration()\r\n\t\t);\r\n\r\n\t\t// Translation: Wheel\r\n\t\tconst wheelTranslation = options && options.translation && options.translation.wheel;\r\n\t\tthis._isWheelTranslationEnabled = ( wheelTranslation && wheelTranslation.enable != null ?\r\n\t\t\twheelTranslation.enable : theme.isWheelTranslationEnabled()\r\n\t\t);\r\n\t\tthis._wheelTranslationSpeed = ( wheelTranslation && wheelTranslation.speed != null ?\r\n\t\t\twheelTranslation.speed : theme.getWheelTranslationSpeed()\r\n\t\t);\r\n\t\tthis._wheelTranslationModifier = ( wheelTranslation && wheelTranslation.modifier != null ?\r\n\t\t\t( isString( wheelTranslation.modifier ) ?\r\n\t\t\t\tDMouseModifier[ wheelTranslation.modifier ] : wheelTranslation.modifier\r\n\t\t\t) :\r\n\t\t\ttheme.getWheelTranslationModifier()\r\n\t\t);\r\n\t\tthis._wheelTranslationChecker = ( wheelTranslation && wheelTranslation.checker ) || DMouseModifiers.match;\r\n\r\n\t\t// Drag\r\n\t\tthis._drag = new DViewDragImpl( parent, toTarget, this, theme, options && options.drag );\r\n\r\n\t\t// Transform\r\n\t\tthis._transform = new DViewTransformImpl( parent, toTarget, this, this._dblclickZoomDuration );\r\n\t}\r\n\r\n\tget drag(): DViewDrag {\r\n\t\treturn this._drag;\r\n\t}\r\n\r\n\tstop(): void {\r\n\t\tthis._drag.stop();\r\n\t\tthis._transform.stop();\r\n\t}\r\n\r\n\treset( duration?: number, stop?: boolean ): void {\r\n\t\tconst parent = this._parent;\r\n\t\tconst target = this._toTarget( parent );\r\n\t\tif( target ) {\r\n\t\t\tconst targetRect = target.getLocalBounds( this._workRect );\r\n\t\t\tconst newTargetX = (parent.width - targetRect.width) * 0.5 - targetRect.x;\r\n\t\t\tconst newTargetY = (parent.height - targetRect.height) * 0.5 - targetRect.y;\r\n\t\t\tthis._transform.start( target, newTargetX, newTargetY, 1, 1, duration, stop );\r\n\t\t}\r\n\t}\r\n\r\n\tfit( duration?: number, stop?: boolean ): void {\r\n\t\tconst parent = this._parent;\r\n\t\tconst target = this._toTarget( parent ) as any;\r\n\t\tif( target ) {\r\n\t\t\tconst padding = parent.padding;\r\n\t\t\tconst width = parent.width;\r\n\t\t\tconst height = parent.height;\r\n\t\t\tconst targetRect = target.getLocalBounds( this._workRect );\r\n\t\t\tconst targetX = targetRect.x;\r\n\t\t\tconst targetY = targetRect.y;\r\n\t\t\tconst targetWidth = targetRect.width;\r\n\t\t\tconst targetHeight = targetRect.height;\r\n\t\t\tlet newTargetScaleX = (width - padding.getLeft() - padding.getRight()) / targetWidth;\r\n\t\t\tlet newTargetScaleY = (height - padding.getTop() - padding.getBottom()) / targetHeight;\r\n\t\t\tif( this._zoomKeepRatio ) {\r\n\t\t\t\tconst newTargetScale = this.toNormalizedScale( Math.min( newTargetScaleX, newTargetScaleY ) );\r\n\t\t\t\tnewTargetScaleX = newTargetScale;\r\n\t\t\t\tnewTargetScaleY = newTargetScale;\r\n\t\t\t} else {\r\n\t\t\t\tnewTargetScaleX = this.toNormalizedScale( newTargetScaleX );\r\n\t\t\t\tnewTargetScaleY = this.toNormalizedScale( newTargetScaleY );\r\n\t\t\t}\r\n\t\t\tconst newTargetWidth = targetWidth * newTargetScaleX;\r\n\t\t\tconst newTargetHeight = targetHeight * newTargetScaleY;\r\n\t\t\tconst newTargetX = (width - newTargetWidth) * 0.5 - targetX * newTargetScaleX;\r\n\t\t\tconst newTargetY = (height - newTargetHeight) * 0.5 - targetY * newTargetScaleY;\r\n\t\t\tthis._transform.start( target, newTargetX, newTargetY, newTargetScaleX, newTargetScaleY, duration, stop );\r\n\t\t}\r\n\t}\r\n\r\n\tzoomIn( duration?: number, stop?: boolean ): void {\r\n\t\tconst target = this._toTarget( this._parent );\r\n\t\tif( target ) {\r\n\t\t\tconst factor = this._dblClickZoomSpeed;\r\n\t\t\tconst targetScale = target.scale;\r\n\t\t\tthis.zoom( targetScale.x * factor, targetScale.y * factor, duration, stop );\r\n\t\t}\r\n\t}\r\n\r\n\tzoomOut( duration?: number, stop?: boolean ): void {\r\n\t\tconst target = this._toTarget( this._parent );\r\n\t\tif( target ) {\r\n\t\t\tconst factor = 1 / this._dblClickZoomSpeed;\r\n\t\t\tconst targetScale = target.scale;\r\n\t\t\tthis.zoom( targetScale.x * factor, targetScale.y * factor, duration, stop );\r\n\t\t}\r\n\t}\r\n\r\n\tzoomAt( x: number, y: number, scaleX: number, scaleY: number, duration?: number, stop?: boolean ): void {\r\n\t\tconst target = this._toTarget( this._parent );\r\n\t\tif( target ) {\r\n\t\t\t// Scale\r\n\t\t\tconst oldScaleX = target.scale.x;\r\n\t\t\tconst oldScaleY = target.scale.y;\r\n\t\t\tconst newScaleX = this.toNormalizedScale( scaleX );\r\n\t\t\tconst newScaleY = this.toNormalizedScale( scaleY );\r\n\t\t\tconst scaleRatioX = newScaleX / oldScaleX;\r\n\t\t\tconst scaleRatioY = newScaleY / oldScaleY;\r\n\r\n\t\t\t// Position\r\n\t\t\tconst newX = (target.position.x - x) * scaleRatioX + x;\r\n\t\t\tconst newY = (target.position.y - y) * scaleRatioY + y;\r\n\r\n\t\t\t// Start\r\n\t\t\tthis._transform.start( target, newX, newY, newScaleX, newScaleY, duration, stop );\r\n\t\t}\r\n\t}\r\n\r\n\tzoomAtGlobal( x: number, y: number, scaleX: number, scaleY: number, duration?: number, stop?: boolean ): void {\r\n\t\tconst local = this._zoomPoint;\r\n\t\tlocal.set( x, y );\r\n\t\tthis.toLocal( local, local );\r\n\t\tthis.zoomAt( local.x, local.y, scaleX, scaleY, duration, stop );\r\n\t}\r\n\r\n\tzoom( scaleX: number, scaleY: number, duration?: number, stop?: boolean ): void {\r\n\t\tconst parent = this._parent;\r\n\t\tthis.zoomAt( parent.width * 0.5, parent.height * 0.5, scaleX, scaleY, duration, stop );\r\n\t}\r\n\r\n\tget scale(): DViewTargetPoint {\r\n\t\tconst target = this._toTarget( this._parent );\r\n\t\tif( target ) {\r\n\t\t\treturn target.scale;\r\n\t\t}\r\n\t\treturn new Point( 1, 1 );\r\n\t}\r\n\r\n\tset scale( scale: DViewTargetPoint ) {\r\n\t\tconst target = this._toTarget( this._parent );\r\n\t\tif( target ) {\r\n\t\t\tconst newScaleX = this.toNormalizedScale( scale.x );\r\n\t\t\tconst newScaleY = this.toNormalizedScale( scale.y );\r\n\t\t\ttarget.scale.set( newScaleX, newScaleY );\r\n\t\t}\r\n\t}\r\n\r\n\tmoveTo( x: number, y: number, duration?: number, stop?: boolean ): void {\r\n\t\tconst target = this._toTarget( this._parent );\r\n\t\tif( target ) {\r\n\t\t\tconst targetScale = target.scale;\r\n\t\t\tthis._transform.start( target, x, y, targetScale.x, targetScale.y, duration, stop );\r\n\t\t}\r\n\t}\r\n\r\n\tget position(): DViewTargetPoint {\r\n\t\tconst target = this._toTarget( this._parent );\r\n\t\tif( target ) {\r\n\t\t\treturn target.position;\r\n\t\t}\r\n\t\treturn new Point( 0, 0 );\r\n\t}\r\n\r\n\tset position( position: DViewTargetPoint ) {\r\n\t\tconst target = this._toTarget( this._parent );\r\n\t\tif( target ) {\r\n\t\t\ttarget.position.set( position.x, position.y );\r\n\t\t}\r\n\t}\r\n\r\n\ttransform(\r\n\t\tx: number, y: number,\r\n\t\tscaleX: number, scaleY: number,\r\n\t\tduration?: number, stop?: boolean\r\n\t): void {\r\n\t\tconst target = this._toTarget( this._parent );\r\n\t\tif( target ) {\r\n\t\t\tthis._transform.start( target, x, y, scaleX, scaleY, duration, stop );\r\n\t\t}\r\n\t}\r\n\r\n\ttoLocal( global: IPoint, local: IPoint, skipUpdate?: boolean ): IPoint {\r\n\t\treturn this._parent.toLocal( global, undefined, local, skipUpdate );\r\n\t}\r\n\r\n\ttoGlobal( local: IPoint, global: IPoint, skipUpdate?: boolean ): IPoint {\r\n\t\treturn this._parent.toGlobal( local, global, skipUpdate );\r\n\t}\r\n\r\n\ttoNormalizedScale( scale: number ): number {\r\n\t\treturn Math.min( this._zoomMax, Math.max( this._zoomMin, scale ) );\r\n\t}\r\n\r\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\r\n\t\tif( this._isWheelZoomEnabled &&\r\n\t\t\tthis._wheelZoomChecker( e, this._wheelZoomModifier, this._parent ) ) {\r\n\t\t\tif( deltas.deltaY !== 0 ) {\r\n\t\t\t\tconst target = this._toTarget( this._parent );\r\n\t\t\t\tif( target ) {\r\n\t\t\t\t\tconst speed = deltas.lowest * this._wheelZoomSpeed;\r\n\t\t\t\t\tconst factor = 1 + deltas.deltaY * speed;\r\n\t\t\t\t\tconst targetScale = target.scale;\r\n\t\t\t\t\tthis.zoomAtGlobal( global.x, global.y, targetScale.x * factor, targetScale.y * factor, 0 );\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif( this._isWheelTranslationEnabled &&\r\n\t\t\tthis._wheelTranslationChecker( e, this._wheelTranslationModifier, this._parent ) ) {\r\n\t\t\tconst target = this._toTarget( this._parent );\r\n\t\t\tif( target ) {\r\n\t\t\t\tthis.stop();\r\n\t\t\t\tconst speed = deltas.lowest * this._wheelTranslationSpeed;\r\n\t\t\t\ttarget.position.set(\r\n\t\t\t\t\ttarget.position.x - deltas.deltaX * speed,\r\n\t\t\t\t\ttarget.position.y + deltas.deltaY * speed\r\n\t\t\t\t);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tonDown( e: interaction.InteractionEvent ): void {\r\n\t\tthis._drag.onDown( e );\r\n\t}\r\n\r\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\r\n\t\tif( this._isDblClickZoomEnabled &&\r\n\t\t\tthis._dblClickZoomChecker( e, this._dblClickZoomModifier, this._parent ) ) {\r\n\t\t\tconst target = this._toTarget( this._parent );\r\n\t\t\tif( target ) {\r\n\t\t\t\tconst global = this._zoomPoint;\r\n\t\t\t\tUtilPointerEvent.toGlobal( e, interactionManager, global );\r\n\t\t\t\tconst factor = this._dblClickZoomSpeed;\r\n\t\t\t\tconst targetScale = target.scale;\r\n\t\t\t\tthis.zoomAtGlobal( global.x, global.y, targetScale.x * factor, targetScale.y * factor, this._dblclickZoomDuration );\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprotected toTheme( options?: DViewOptions ): DThemeView | null {\r\n\t\tif( options && options.theme ) {\r\n\t\t\tconst theme = options.theme;\r\n\t\t\tif( isString( theme ) ) {\r\n\t\t\t\treturn DThemes.getInstance().get( theme );\r\n\t\t\t} else {\r\n\t\t\t\treturn theme;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprotected getThemeDefault(): DThemeView {\r\n\t\treturn DThemes.getInstance().get( this.getType() );\r\n\t}\r\n\r\n\tprotected getType(): string {\r\n\t\treturn \"DView\";\r\n\t}\r\n}\r\n"]}