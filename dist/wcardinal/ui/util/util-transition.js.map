{"version":3,"file":"util-transition.js","sourceRoot":"","sources":["../../../../src/main/typescript/wcardinal/ui/util/util-transition.ts"],"names":[],"mappings":"AAAA;;;GAGG;AAQH;IAMC,wBAAa,OAA+B;QAC3C,IAAI,CAAC,SAAS,GAAG,CAAE,OAAO,IAAI,IAAI,IAAI,OAAO,CAAC,QAAQ,IAAI,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAE,CAAC;QAC1F,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACrB,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;QACrB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;IACvB,CAAC;IAED,6BAAI,GAAJ,UAAM,IAA4B,EAAE,QAAkB;QAAtD,iBAoBC;QAnBA,IAAM,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC;QAChC,IAAI,QAAQ,IAAI,IAAI,EAAG;YACtB,YAAY,CAAE,QAAQ,CAAE,CAAC;SACzB;QAED,IAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC9B,IAAI,IAAI,KAAK,OAAO,EAAG;YACtB,IAAM,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC;YAChC,IAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC;YACpC,IAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YACvB,IAAM,SAAS,GAAG,CAAC,UAAU,GAAG,QAAQ,CAAC,GAAG,GAAG,CAAC;YAChD,IAAI,QAAQ,KAAK,IAAI,IAAI,SAAS,IAAI,CAAC,EAAG;gBACzC,IAAI,CAAC,MAAM,CAAE,GAAG,EAAE,IAAI,CAAE,CAAC;aACzB;iBAAM;gBACN,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,UAAU,CAAC;oBAClC,KAAI,CAAC,MAAM,CAAE,IAAI,CAAC,GAAG,EAAE,EAAE,IAAI,CAAE,CAAC;gBACjC,CAAC,EAAE,SAAS,CAAE,CAAC;aACf;SACD;IACF,CAAC;IAES,+BAAM,GAAhB,UAAkB,GAAW,EAAE,IAA4B;QAC1D,IAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC9B,IAAI,OAAO,KAAK,IAAI,EAAG;YACtB,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC;YAEvB,IAAI,OAAO,KAAK,IAAI,EAAG;gBACtB,OAAO,CAAC,IAAI,EAAE,CAAC;aACf;YAED,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,IAAI,IAAI,IAAI,EAAG;gBAClB,IAAI,CAAC,IAAI,EAAE,CAAC;aACZ;SACD;IACF,CAAC;IAED,6BAAI,GAAJ;QACC,IAAI,CAAC,IAAI,CAAE,IAAI,CAAE,CAAC;IACnB,CAAC;IACF,qBAAC;AAAD,CAAC,AAtDD,IAsDC","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { DBase } from \"../d-base\";\r\n\r\nexport interface UtilTransitionOptions {\r\n\tduration?: number;\r\n}\r\n\r\nexport class UtilTransition {\r\n\tprotected _duration: number;\r\n\tprotected _current: DBase<any, any> | null;\r\n\tprotected _lastUpdate: number;\r\n\tprotected _updateId: number | null;\r\n\r\n\tconstructor( options?: UtilTransitionOptions ) {\r\n\t\tthis._duration = ( options != null && options.duration != null ? options.duration : 300 );\r\n\t\tthis._current = null;\r\n\t\tthis._lastUpdate = 0;\r\n\t\tthis._updateId = null;\r\n\t}\r\n\r\n\tshow( next: DBase<any, any> | null, forcibly?: boolean ): void {\r\n\t\tconst updateId = this._updateId;\r\n\t\tif( updateId != null ) {\r\n\t\t\tclearTimeout( updateId );\r\n\t\t}\r\n\r\n\t\tconst current = this._current;\r\n\t\tif( next !== current ) {\r\n\t\t\tconst duration = this._duration;\r\n\t\t\tconst lastUpdate = this._lastUpdate;\r\n\t\t\tconst now = Date.now();\r\n\t\t\tconst remaining = (lastUpdate + duration) - now;\r\n\t\t\tif( forcibly === true || remaining <= 0 ) {\r\n\t\t\t\tthis.update( now, next );\r\n\t\t\t} else {\r\n\t\t\t\tthis._updateId = window.setTimeout(() => {\r\n\t\t\t\t\tthis.update( Date.now(), next );\r\n\t\t\t\t}, remaining );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected update( now: number, next: DBase<any, any> | null ) {\r\n\t\tconst current = this._current;\r\n\t\tif( current !== next ) {\r\n\t\t\tthis._lastUpdate = now;\r\n\r\n\t\t\tif( current !== null ) {\r\n\t\t\t\tcurrent.hide();\r\n\t\t\t}\r\n\r\n\t\t\tthis._current = next;\r\n\t\t\tif( next != null ) {\r\n\t\t\t\tnext.show();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thide(): void {\r\n\t\tthis.show( null );\r\n\t}\r\n}\r\n"]}