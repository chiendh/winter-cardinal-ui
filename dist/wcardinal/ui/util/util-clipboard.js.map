{"version":3,"file":"util-clipboard.js","sourceRoot":"","sources":["../../../../src/main/typescript/wcardinal/ui/util/util-clipboard.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { utils } from \"pixi.js\";\r\n\r\nconst getSelection = ( element: Element ): Selection | null => {\r\n\tconst selection = document.getSelection();\r\n\tif( selection ) {\r\n\t\tconst range = document.createRange();\r\n\t\trange.selectNodeContents( element );\r\n\t\tselection.removeAllRanges();\r\n\t\tselection.addRange( range );\r\n\t}\r\n\treturn selection;\r\n};\r\n\r\nconst toClipboardData = ( e: ClipboardEvent ): DataTransfer => {\r\n\treturn e.clipboardData || (window as any).clipboardData;\r\n};\r\n\r\nconst copyUsingDiv = ( text: string ): boolean => {\r\n\tconst div = document.createElement( \"div\" );\r\n\tdiv.setAttribute( \"style\", \"-webkit-user-select: text !important\" );\r\n\tdiv.textContent = \"Dummy\";\r\n\tdocument.body.appendChild( div );\r\n\tconst selection = getSelection( div );\r\n\tlet result = false;\r\n\tif( selection ) {\r\n\t\tconst handler = ( e: ClipboardEvent ): void => {\r\n\t\t\tif( e.target === div ) {\r\n\t\t\t\tconst clipboardData = toClipboardData( e );\r\n\t\t\t\tclipboardData.setData( \"text/plain\", text );\r\n\t\t\t\tresult = ( clipboardData.getData( \"text/plain\" ) === text );\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t};\r\n\t\tdocument.addEventListener( \"copy\", handler );\r\n\t\ttry {\r\n\t\t\tdocument.execCommand( \"copy\" );\r\n\t\t} finally {\r\n\t\t\tdocument.removeEventListener( \"copy\", handler );\r\n\t\t}\r\n\t\tselection.removeAllRanges();\r\n\t}\r\n\tdocument.body.removeChild( div );\r\n\treturn result;\r\n};\r\n\r\nconst copyUsingSpan = ( text: string ): boolean => {\r\n\tconst div = document.createElement( \"div\" );\r\n\tdiv.setAttribute( \"style\", \"-webkit-user-select: text !important\" );\r\n\tconst span = document.createElement( \"span\" );\r\n\tspan.innerText = text;\r\n\tconst root: Node = ( div.attachShadow ? div.attachShadow({ mode: \"open\" }) : div );\r\n\troot.appendChild( span );\r\n\tdocument.body.appendChild( div );\r\n\tlet result = false;\r\n\tconst selection = getSelection( div );\r\n\tif( selection ) {\r\n\t\tresult = document.execCommand( \"copy\" );\r\n\t\tselection.removeAllRanges();\r\n\t}\r\n\tdocument.body.removeChild( div );\r\n\treturn result;\r\n};\r\n\r\nconst copyUsingWindow = ( window: Window, text: string ): boolean => {\r\n\tif( typeof ClipboardEvent === \"undefined\" ) {\r\n\t\tconst clipboardData = (window as any).clipboardData;\r\n\t\tif( typeof clipboardData !== \"undefined\" && typeof clipboardData.setData !== \"undefined\" ) {\r\n\t\t\tclipboardData.setData( \"Text\", text );\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nexport class UtilClipboard extends utils.EventEmitter {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tconst element = document.body;\r\n\t\telement.addEventListener( \"copy\", ( e: ClipboardEvent ): void => {\r\n\t\t\tif( e.target === element ) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\tthis.emit( \"copy\", toClipboardData( e ) );\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\telement.addEventListener( \"cut\", ( e: ClipboardEvent ): void => {\r\n\t\t\tif( e.target === element ) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\tthis.emit( \"cut\", toClipboardData( e ) );\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\telement.addEventListener( \"paste\", ( e: ClipboardEvent ): void => {\r\n\t\t\tif( e.target === element ) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\tthis.emit( \"paste\", toClipboardData( e ) );\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tstatic copy( text: string ): void {\r\n\t\tconst clipboard = navigator.clipboard;\r\n\t\tif( clipboard && clipboard.writeText ) {\r\n\t\t\tclipboard.writeText( text );\r\n\t\t} else {\r\n\t\t\tif( ! copyUsingWindow( window, text ) ) {\r\n\t\t\t\tif( ! copyUsingDiv( text ) ) {\r\n\t\t\t\t\tif( navigator.userAgent.indexOf( \"Edge\" ) < 0 ) {\r\n\t\t\t\t\t\tcopyUsingSpan( text );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n"]}