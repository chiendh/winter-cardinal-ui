{"version":3,"file":"dynamic-sdf-font-generator.js","sourceRoot":"","sources":["../../../../src/main/typescript/wcardinal/ui/util/dynamic-sdf-font-generator.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nconst VERTEX_SHADER = `\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nvarying mediump vec2 vTextureCoord;\r\nvoid main(void) {\r\n\tgl_Position = vec4(aVertexPosition, 0.0, 1.0);\r\n\tvTextureCoord = aTextureCoord;\r\n}\r\n`;\r\n\r\nconst FRAGMENT_SHADER = `\r\nprecision mediump float;\r\n\r\nvarying mediump vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\nuniform vec2 uSize;\r\n\r\nfloat calcDistance( float x, float y, float dx, float dy ) {\r\n\tfloat xd = x + dx;\r\n\tfloat yd = y + dy;\r\n\tfloat u = xd / uSize.x;\r\n\tfloat v = yd / uSize.y;\r\n\tfloat ul = (xd - 1.0) / uSize.x;\r\n\tfloat vt = (yd - 1.0) / uSize.y;\r\n\r\n\tfloat m = texture2D(uSampler, vec2(u , v )).a;\r\n\tfloat l = texture2D(uSampler, vec2(ul, v )).a;\r\n\tfloat t = texture2D(uSampler, vec2(u , vt)).a;\r\n\r\n\tfloat xl = mix( xd - 1.0, xd, (0.5 - l) / (m - l) );\r\n\tfloat yt = mix( yd - 1.0, yd, (0.5 - t) / (m - t) );\r\n\r\n\tbool bl = ( min(l, m) < 0.5 && 0.5 <= max(l, m) );\r\n\tbool bt = ( min(t, m) < 0.5 && 0.5 <= max(t, m) );\r\n\r\n\tfloat ll = (bl ? length( vec2( xl - x, yd - y ) ) : 100.0);\r\n\tfloat lt = (bt ? length( vec2( xd - x, yt - y ) ) : 100.0);\r\n\r\n\treturn min( ll, lt );\r\n}\r\n\r\nfloat calcDistancesY( float x, float y, float dx ) {\r\n\tfloat d = 100.0;\r\n\tfor( float dy=-6.0; dy<6.5; dy++ ) {\r\n\t\td = min( d, calcDistance( x, y, dx, dy ) );\r\n\t}\r\n\treturn d;\r\n}\r\n\r\nfloat calcDistances( float x, float y ) {\r\n\tfloat d = 100.0;\r\n\tfor( float dx=-6.0; dx<6.5; dx++ ) {\r\n\t\td = min( d, calcDistancesY( x, y, dx ) );\r\n\t}\r\n\treturn d;\r\n}\r\n\r\nvoid main(void) {\r\n\tfloat t = texture2D(uSampler, vTextureCoord).a;\r\n\tfloat x = vTextureCoord.x * uSize.x;\r\n\tfloat y = vTextureCoord.y * uSize.y;\r\n\tfloat d = min( 6.0, calcDistances( x, y ) ) / 12.0;\r\n\td = clamp( mix( 0.5 - d, 0.5 + d, step( 0.5, t ) ), 0.0, 1.0 );\r\n\tgl_FragColor = vec4(1.0, 1.0, 1.0, d);\r\n}\r\n`;\r\n\r\nexport class DynamicSDFFontGenerator {\r\n\tprotected static _INSTANCE: DynamicSDFFontGenerator | null = null;\r\n\r\n\tprotected _canvas: HTMLCanvasElement | null;\r\n\tprotected _onLostBound: EventListener;\r\n\tprotected _onRestoreBound: EventListener;\r\n\tprotected _onUnloadBound: EventListener;\r\n\tprotected _gl: WebGLRenderingContext | null;\r\n\tprotected _texture: WebGLTexture | null;\r\n\tprotected _shaderProgram: WebGLProgram | null;\r\n\tprotected _vertexPositionAttribute: number;\r\n\tprotected _textureCoordAttribute: number;\r\n\tprotected _samplerUniform: WebGLUniformLocation | null;\r\n\tprotected _sizeUniform: WebGLUniformLocation | null;\r\n\tprotected _vb: WebGLBuffer | null;\r\n\tprotected _uvb: WebGLBuffer | null;\r\n\r\n\tconstructor() {\r\n\t\tthis._gl = null;\r\n\t\tthis._texture = null;\r\n\t\tthis._shaderProgram = null;\r\n\t\tthis._vertexPositionAttribute = NaN;\r\n\t\tthis._textureCoordAttribute = NaN;\r\n\t\tthis._samplerUniform = NaN;\r\n\t\tthis._sizeUniform = NaN;\r\n\t\tthis._vb = null;\r\n\t\tthis._uvb = null;\r\n\r\n\t\tconst canvas = this._canvas = document.createElement( \"canvas\" );\r\n\t\tcanvas.width = 64;\r\n\t\tcanvas.height = 64;\r\n\t\tthis._onLostBound = ( e: Event ): void => {\r\n\t\t\te.preventDefault();\r\n\t\t};\r\n\t\tthis._onRestoreBound = (): void => {\r\n\t\t\tthis.restore();\r\n\t\t};\r\n\t\tthis._onUnloadBound = (): void => {\r\n\t\t\tthis.destroy();\r\n\t\t};\r\n\t\tcanvas.addEventListener( \"webglcontextlost\", this._onLostBound, false);\r\n\t\tcanvas.addEventListener( \"webglcontextrestored\", this._onRestoreBound, false);\r\n\t\twindow.addEventListener( \"unload\", this._onUnloadBound, false );\r\n\t}\r\n\r\n\tinit(): this {\r\n\t\tconst canvas = this._canvas;\r\n\t\tif( canvas != null && (this._gl == null || this._gl.isContextLost()) ) {\r\n\t\t\tconst config: WebGLContextAttributes = {\r\n\t\t\t\talpha: true,\r\n\t\t\t\tantialias: false,\r\n\t\t\t\tdepth: false,\r\n\t\t\t\tstencil: false,\r\n\t\t\t\tpremultipliedAlpha: false\r\n\t\t\t};\r\n\t\t\tconst gl = this._gl = (\r\n\t\t\t\tcanvas.getContext( \"webgl\", config ) ||\r\n\t\t\t\tcanvas.getContext( \"experimental-webgl\", config ) as WebGLRenderingContext | null\r\n\t\t\t);\r\n\t\t\tif( gl != null ) {\r\n\t\t\t\tgl.clearColor(1.0, 1.0, 1.0, 0.0);\r\n\t\t\t\tthis.makeVertexBuffer();\r\n\t\t\t\tthis.makeUvBuffer();\r\n\t\t\t\tthis.makeShaders();\r\n\t\t\t\tthis._texture = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\trestore(): void {\r\n\t\tthis.init();\r\n\t}\r\n\r\n\tgetCanvas(): HTMLCanvasElement | null {\r\n\t\treturn this._canvas;\r\n\t}\r\n\r\n\tgetShader( gl: WebGLRenderingContext, code: string, type: boolean ): WebGLShader | null {\r\n\t\tconst shader = ( type ?\r\n\t\t\tgl.createShader( gl.FRAGMENT_SHADER ) :\r\n\t\t\tgl.createShader( gl.VERTEX_SHADER )\r\n\t\t);\r\n\t\tif( shader != null ) {\r\n\t\t\tgl.shaderSource( shader, code );\r\n\t\t\tgl.compileShader( shader );\r\n\t\t\tif( ! gl.getShaderParameter( shader, gl.COMPILE_STATUS ) ) {\r\n\t\t\t\t// tslint:disable-next-line: no-console no-unused-expression\r\n\t\t\t\tconsole && console.error( `Failed to compile the shader: ${gl.getShaderInfoLog(shader)}` );\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn shader;\r\n\t}\r\n\r\n\tmakeShaders(): WebGLShader | null {\r\n\t\tconst gl = this._gl;\r\n\t\tif( gl != null && gl.isContextLost() !== true ) {\r\n\t\t\tconst vertexShader = this.getShader( gl, VERTEX_SHADER, false );\r\n\t\t\tif( vertexShader != null ) {\r\n\t\t\t\tconst fragmentShader = this.getShader( gl, FRAGMENT_SHADER, true );\r\n\t\t\t\tif( fragmentShader != null ) {\r\n\t\t\t\t\tconst shaderProgram = this._shaderProgram = gl.createProgram();\r\n\t\t\t\t\tif( shaderProgram != null ) {\r\n\t\t\t\t\t\tgl.attachShader( shaderProgram, vertexShader );\r\n\t\t\t\t\t\tgl.attachShader( shaderProgram, fragmentShader );\r\n\t\t\t\t\t\tgl.linkProgram( shaderProgram );\r\n\t\t\t\t\t\tif( ! gl.getProgramParameter(shaderProgram, gl.LINK_STATUS) ) {\r\n\t\t\t\t\t\t\t// tslint:disable-next-line: no-console no-unused-expression\r\n\t\t\t\t\t\t\tconsole && console.error( `Failed to link the program: ${gl.getError()}` );\r\n\t\t\t\t\t\t\tgl.deleteShader( vertexShader );\r\n\t\t\t\t\t\t\tgl.deleteShader( fragmentShader );\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tgl.deleteShader( vertexShader );\r\n\t\t\t\t\t\t\tgl.deleteShader( fragmentShader );\r\n\r\n\t\t\t\t\t\t\tgl.useProgram( shaderProgram );\r\n\t\t\t\t\t\t\tthis._vertexPositionAttribute = gl.getAttribLocation( shaderProgram, \"aVertexPosition\" );\r\n\t\t\t\t\t\t\tthis._textureCoordAttribute = gl.getAttribLocation( shaderProgram, \"aTextureCoord\" );\r\n\t\t\t\t\t\t\tthis._samplerUniform = gl.getUniformLocation( shaderProgram, \"uSampler\" );\r\n\t\t\t\t\t\t\tthis._sizeUniform = gl.getUniformLocation( shaderProgram, \"uSize\" );\r\n\t\t\t\t\t\t\tgl.useProgram( null );\r\n\t\t\t\t\t\t\treturn shaderProgram;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tgl.deleteShader( vertexShader );\r\n\t\t\t\t\t\tgl.deleteShader( fragmentShader );\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgl.deleteShader( vertexShader );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tdestroyShaders(): void {\r\n\t\tconst gl = this._gl;\r\n\t\tif( gl != null && gl.isContextLost() !== true ) {\r\n\t\t\tconst shaderProgram = this._shaderProgram;\r\n\t\t\tif( shaderProgram != null ) {\r\n\t\t\t\tthis._shaderProgram = null;\r\n\t\t\t\tgl.useProgram( null );\r\n\t\t\t\tgl.deleteProgram( shaderProgram );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tupdateTexture( source: TexImageSource ): WebGLTexture | null {\r\n\t\tconst gl = this._gl;\r\n\t\tconst canvas = this._canvas;\r\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null ) {\r\n\t\t\tconst width = source.width;\r\n\t\t\tconst height = source.height;\r\n\t\t\tif( canvas.width !== width || canvas.height !== height ) {\r\n\t\t\t\tcanvas.width = width;\r\n\t\t\t\tcanvas.height = height;\r\n\t\t\t\tgl.viewport( 0, 0, width, height );\r\n\t\t\t}\r\n\r\n\t\t\tlet texture = this._texture;\r\n\t\t\tif( texture == null ) {\r\n\t\t\t\ttexture = this._texture = gl.createTexture();\r\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\r\n\t\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source );\r\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\r\n\t\t\t} else {\r\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\r\n\t\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source );\r\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\r\n\t\t\t}\r\n\t\t\treturn texture;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tdestroyTexture(): void {\r\n\t\tconst gl = this._gl;\r\n\t\tconst texture = this._texture;\r\n\t\tif( gl != null && gl.isContextLost() !== true && texture != null ) {\r\n\t\t\tthis._texture = null;\r\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\r\n\t\t\tgl.deleteTexture( texture );\r\n\t\t}\r\n\t}\r\n\r\n\tmakeVertexBuffer(): WebGLBuffer | null {\r\n\t\tconst gl = this._gl;\r\n\t\tif( gl != null && gl.isContextLost() !== true ) {\r\n\t\t\tconst vb = this._vb = gl.createBuffer();\r\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vb );\r\n\r\n\t\t\tconst vertices = [\r\n\t\t\t\t-1.0, +1.0,\r\n\t\t\t\t+1.0, +1.0,\r\n\t\t\t\t-1.0, -1.0,\r\n\t\t\t\t+1.0, -1.0\r\n\t\t\t];\r\n\r\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW );\r\n\t\t\treturn vb;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tdestroyVertexBuffer(): void {\r\n\t\tconst gl = this._gl;\r\n\t\tconst vb = this._vb;\r\n\t\tif( gl != null && gl.isContextLost() !== true && vb != null ) {\r\n\t\t\tthis._vb = null;\r\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\r\n\t\t\tgl.deleteBuffer( vb );\r\n\t\t}\r\n\t}\r\n\r\n\tmakeUvBuffer(): WebGLBuffer | null {\r\n\t\tconst gl = this._gl;\r\n\t\tif( gl != null && gl.isContextLost() !== true ) {\r\n\t\t\tconst uvb = this._uvb = gl.createBuffer();\r\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, uvb );\r\n\r\n\t\t\tconst uvs = [\r\n\t\t\t\t0.0,  0.0,\r\n\t\t\t\t1.0,  0.0,\r\n\t\t\t\t0.0,  1.0,\r\n\t\t\t\t1.0,  1.0\r\n\t\t\t];\r\n\r\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, new Float32Array(uvs), gl.STATIC_DRAW );\r\n\t\t\treturn uvb;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tdestroyUvBuffer(): void {\r\n\t\tconst gl = this._gl;\r\n\t\tconst uvb = this._uvb;\r\n\t\tif( gl != null && gl.isContextLost() !== true && uvb != null ) {\r\n\t\t\tthis._uvb = null;\r\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\r\n\t\t\tgl.deleteBuffer( uvb );\r\n\t\t}\r\n\t}\r\n\r\n\trender(): void {\r\n\t\tconst gl = this._gl;\r\n\t\tconst canvas = this._canvas;\r\n\t\tconst shaderProgram = this._shaderProgram;\r\n\t\tconst vb = this._vb;\r\n\t\tconst uvb = this._uvb;\r\n\t\tconst texture = this._texture;\r\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null &&\r\n\t\t\tshaderProgram != null && vb != null && uvb != null && texture != null ) {\r\n\t\t\tgl.clear( gl.COLOR_BUFFER_BIT );\r\n\r\n\t\t\tgl.useProgram( shaderProgram );\r\n\r\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vb );\r\n\t\t\tconst vertexPositionAttribute = this._vertexPositionAttribute;\r\n\t\t\tgl.enableVertexAttribArray( vertexPositionAttribute );\r\n\t\t\tgl.vertexAttribPointer( vertexPositionAttribute, 2, gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, uvb );\r\n\t\t\tconst textureCoordAttribute = this._textureCoordAttribute;\r\n\t\t\tgl.enableVertexAttribArray( textureCoordAttribute );\r\n\t\t\tgl.vertexAttribPointer( textureCoordAttribute, 2, gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\tgl.activeTexture( gl.TEXTURE0 );\r\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\r\n\t\t\tgl.uniform1i( this._samplerUniform, 0 );\r\n\t\t\tgl.uniform2f( this._sizeUniform, canvas.width, canvas.height );\r\n\r\n\t\t\tgl.drawArrays( gl.TRIANGLE_STRIP, 0, 4 );\r\n\r\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\r\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\r\n\t\t\tgl.useProgram( null );\r\n\t\t}\r\n\t}\r\n\r\n\tread( copyCanvas: HTMLCanvasElement ): void {\r\n\t\tconst gl = this._gl;\r\n\t\tconst canvas = this._canvas;\r\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null ) {\r\n\t\t\tconst width = canvas.width;\r\n\t\t\tconst height = canvas.height;\r\n\t\t\tcopyCanvas.width = width;\r\n\t\t\tcopyCanvas.height = height;\r\n\t\t\tconst copyContext = copyCanvas.getContext( \"2d\" );\r\n\t\t\tif( copyContext != null ) {\r\n\t\t\t\tcopyContext.drawImage( canvas, 0, 0 );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdestroy(): void {\r\n\t\tthis.destroyVertexBuffer();\r\n\t\tthis.destroyUvBuffer();\r\n\t\tthis.destroyShaders();\r\n\r\n\t\tconst canvas = this._canvas;\r\n\t\tif( canvas != null ) {\r\n\t\t\tthis._canvas = null;\r\n\t\t\tcanvas.removeEventListener( \"webglcontextlost\", this._onLostBound, false);\r\n\t\t\tcanvas.removeEventListener( \"webglcontextrestored\", this._onRestoreBound, false);\r\n\t\t\twindow.removeEventListener( \"unload\", this._onUnloadBound, false );\r\n\t\t}\r\n\r\n\t\tconst gl = this._gl;\r\n\t\tif( gl != null ) {\r\n\t\t\tthis._gl = null;\r\n\t\t\tconst WebGLLoseContext = gl.getExtension( \"WEBGL_lose_context\" );\r\n\t\t\tif( WebGLLoseContext != null ) {\r\n\t\t\t\tWebGLLoseContext.loseContext();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getInstance(): DynamicSDFFontGenerator {\r\n\t\tif( DynamicSDFFontGenerator._INSTANCE == null ) {\r\n\t\t\tDynamicSDFFontGenerator._INSTANCE = new DynamicSDFFontGenerator();\r\n\t\t}\r\n\t\treturn DynamicSDFFontGenerator._INSTANCE;\r\n\t}\r\n}\r\n"]}