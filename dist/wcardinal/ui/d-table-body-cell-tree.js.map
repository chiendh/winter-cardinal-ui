{"version":3,"file":"d-table-body-cell-tree.js","sourceRoot":"","sources":["../../../src/main/typescript/wcardinal/ui/d-table-body-cell-tree.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { interaction } from \"pixi.js\";\r\nimport { DBasePaddingAdjustable } from \"./d-base-padding-adjustable\";\r\nimport { DBaseState } from \"./d-base-state\";\r\nimport {\r\n\tDTableBodyCellButton, DTableBodyCellButtonOptions, DThemeTableBodyCellButton\r\n} from \"./d-table-body-cell-button\";\r\nimport { DTableBodyCells } from \"./d-table-body-cells\";\r\nimport { DTableCellState } from \"./d-table-cell-state\";\r\nimport { isNumber } from \"./util/is-number\";\r\n\r\nexport interface DTableBodyCellTreeOptions<\r\n\tROW,\r\n\tTHEME extends DThemeTableBodyCellTree = DThemeTableBodyCellTree\r\n> extends DTableBodyCellButtonOptions<ROW, THEME> {\r\n\r\n}\r\n\r\nexport interface DThemeTableBodyCellTree extends DThemeTableBodyCellButton {\r\n\tgetLevelPadding( level: number ): number;\r\n}\r\n\r\nexport class DTableBodyCellTree<\r\n\tROW,\r\n\tTHEME extends DThemeTableBodyCellTree = DThemeTableBodyCellTree,\r\n\tOPTIONS extends DTableBodyCellTreeOptions<ROW, THEME> = DTableBodyCellTreeOptions<ROW, THEME>\r\n> extends DTableBodyCellButton<ROW, THEME, OPTIONS> {\r\n\tprotected _padding!: DBasePaddingAdjustable;\r\n\r\n\tconstructor( options: OPTIONS ) {\r\n\t\tsuper( options );\r\n\t\tthis._padding = new DBasePaddingAdjustable( this._padding );\r\n\t}\r\n\r\n\tprotected onActive( e: KeyboardEvent | interaction.InteractionEvent ): void {\r\n\t\tthis.emit( \"active\", this );\r\n\t\tconst row = this._row;\r\n\t\tif( row !== undefined ) {\r\n\t\t\tconst rowIndex = this._rowIndex;\r\n\t\t\tconst columnIndex = this._columnIndex;\r\n\t\t\tthis.emit( \"cellchange\", null, null, row, rowIndex, columnIndex, this );\r\n\r\n\t\t\tconst parent = this.parent;\r\n\t\t\tif( parent ) {\r\n\t\t\t\tconst body = parent.parent as any;\r\n\t\t\t\tif( body ) {\r\n\t\t\t\t\tconst data = body.data;\r\n\t\t\t\t\tif( data && data.toggle ) {\r\n\t\t\t\t\t\tdata.toggle( row );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tset(\r\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\r\n\t\trowIndex: number, columnIndex: number,\r\n\t\tforcibly?: boolean\r\n\t): void {\r\n\t\tthis._row = row;\r\n\t\tthis._rowIndex = rowIndex;\r\n\t\tthis.text = value;\r\n\r\n\t\tconst columnData = this._columnData;\r\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, columnData );\r\n\r\n\t\tconst adjuster = this._padding.adjuster;\r\n\t\tif( isNumber( supplimental ) ) {\r\n\t\t\tconst isOpened = !! (supplimental & 0x1);\r\n\t\t\tconst hasChildren = !! (supplimental & 0x2);\r\n\t\t\tconst level = (supplimental >> 2);\r\n\t\t\tif( hasChildren ) {\r\n\t\t\t\tif( isOpened ) {\r\n\t\t\t\t\tthis.setStates( DTableCellState.HAS_CHILDREN | DTableCellState.OPENED, DBaseState.NONE );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setStates( DTableCellState.HAS_CHILDREN, DTableCellState.OPENED );\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif( isOpened ) {\r\n\t\t\t\t\tthis.setStates( DTableCellState.OPENED, DTableCellState.HAS_CHILDREN );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setStates( DBaseState.NONE, DTableCellState.HAS_CHILDREN | DTableCellState.OPENED );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tadjuster.left = this.theme.getLevelPadding( level );\r\n\t\t} else {\r\n\t\t\tthis.setStates( DBaseState.NONE, DTableCellState.OPENED | DTableCellState.HAS_CHILDREN );\r\n\t\t\tadjuster.left = 0;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected getType(): string {\r\n\t\treturn \"DTableBodyCellTree\";\r\n\t}\r\n}\r\n"]}