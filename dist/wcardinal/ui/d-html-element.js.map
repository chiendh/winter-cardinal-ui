{"version":3,"file":"d-html-element.js","sourceRoot":"","sources":["../../../src/main/typescript/wcardinal/ui/d-html-element.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * Copyright (C) 2019 Toshiba Corporation\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { interaction, Point, Rectangle, Renderer, Text } from \"pixi.js\";\r\nimport { DApplications } from \"./d-applications\";\r\nimport { DBase } from \"./d-base\";\r\nimport { DBaseState } from \"./d-base-state\";\r\nimport { DDynamicText } from \"./d-dynamic-text\";\r\nimport { DHtmlElementWhen } from \"./d-html-element-when\";\r\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\r\nimport { DPadding } from \"./d-padding\";\r\nimport { isString } from \"./util/is-string\";\r\n\r\nexport type DHtmlElementElementCreator<T> = ( parent: HTMLElement ) => T;\r\n\r\nexport type DHtmlElementStyle<THEME extends DThemeHtmlElement> = (\r\n\ttarget: HTMLElement,\r\n\tstate: DBaseState, theme: THEME, padding: DPadding,\r\n\telementRect: Rectangle, clipperRect: Rectangle\r\n) => void;\r\n\r\nexport type DHtmlElementStyleBefore<THEME extends DThemeHtmlElement> =\r\n\t( target: HTMLElement, theme: THEME ) => void;\r\n\r\nexport type DHtmlElementStyleAfter<THEME extends DThemeHtmlElement> =\r\n\t( target: HTMLElement, theme: THEME ) => void;\r\n\r\nexport interface DHtmlElementElementOptions<ELEMENT, THEME extends DThemeHtmlElement> {\r\n\tcreator?: DHtmlElementElementCreator<ELEMENT>;\r\n\tstyle?: DHtmlElementStyle<THEME>;\r\n}\r\n\r\nexport interface DHtmlElementClipperOptions<THEME extends DThemeHtmlElement> {\r\n\tcreator?: DHtmlElementElementCreator<HTMLDivElement>;\r\n\tstyle?: DHtmlElementStyle<THEME>;\r\n}\r\n\r\nexport interface DHtmlElementBeforeOptions<THEME extends DThemeHtmlElement> {\r\n\tcreator?: DHtmlElementElementCreator<HTMLDivElement>;\r\n\tstyle?: DHtmlElementStyleBefore<THEME>;\r\n}\r\n\r\nexport interface DHtmlElementAfterOptions<THEME extends DThemeHtmlElement> {\r\n\tcreator?: DHtmlElementElementCreator<HTMLDivElement>;\r\n\tstyle?: DHtmlElementStyleAfter<THEME>;\r\n}\r\n\r\nexport interface DHtmlElementOptions<\r\n\tVALUE = unknown,\r\n\tELEMENT extends HTMLElement = HTMLElement,\r\n\tTHEME extends DThemeHtmlElement<ELEMENT> = DThemeHtmlElement<ELEMENT>\r\n> extends DImageBaseOptions<VALUE, THEME> {\r\n\telement?: DHtmlElementElementOptions<ELEMENT, THEME>;\r\n\tclipper?: DHtmlElementClipperOptions<THEME>;\r\n\tbefore?: DHtmlElementBeforeOptions<THEME>;\r\n\tafter?: DHtmlElementAfterOptions<THEME>;\r\n\twhen?: DHtmlElementWhen | (keyof typeof DHtmlElementWhen);\r\n\tselect?: boolean;\r\n}\r\n\r\nexport interface DThemeHtmlElement<\r\n\tELEMENT extends HTMLElement = HTMLElement\r\n> extends DThemeImageBase {\r\n\tgetElementCreator(): DHtmlElementElementCreator<ELEMENT> | null;\r\n\tsetElementStyle(\r\n\t\ttarget: ELEMENT, state: DBaseState, padding: DPadding,\r\n\t\telementRect: Rectangle, clipperRect: Rectangle\r\n\t): void;\r\n\tgetClipperCreator(): DHtmlElementElementCreator<HTMLDivElement> | null;\r\n\tsetClipperStyle(\r\n\t\ttarget: HTMLDivElement, state: DBaseState, padding: DPadding,\r\n\t\telementRect: Rectangle, clipperRect: Rectangle\r\n\t): void;\r\n\tgetBeforeCreator(): DHtmlElementElementCreator<HTMLDivElement> | null;\r\n\tsetBeforeStyle( target: HTMLDivElement ): void;\r\n\tgetAfterCreator(): DHtmlElementElementCreator<HTMLDivElement> | null;\r\n\tsetAfterStyle( target: HTMLDivElement ): void;\r\n\tgetWhen(): DHtmlElementWhen;\r\n\tgetSelect(): boolean;\r\n}\r\n\r\nexport class DHtmlElement<\r\n\tVALUE = unknown,\r\n\tELEMENT extends HTMLElement = HTMLElement,\r\n\tTHEME extends DThemeHtmlElement<ELEMENT> = DThemeHtmlElement<ELEMENT>,\r\n\tOPTIONS extends DHtmlElementOptions<VALUE, ELEMENT, THEME> = DHtmlElementOptions<VALUE, ELEMENT, THEME>\r\n> extends DImageBase<VALUE, THEME, OPTIONS> {\r\n\tprotected _workPoint!: Point | null;\r\n\r\n\tprotected _clipper!: HTMLDivElement | null;\r\n\tprotected _clipperCreator!: DHtmlElementElementCreator<HTMLDivElement> | null;\r\n\tprotected _clipperStyle!: DHtmlElementStyle<THEME> | undefined;\r\n\tprotected _clipperRect!: Rectangle | null;\r\n\r\n\tprotected _element!: ELEMENT | null;\r\n\tprotected _elementCreator!: DHtmlElementElementCreator<ELEMENT> | null;\r\n\tprotected _elementStyle!: DHtmlElementStyle<THEME> | undefined;\r\n\tprotected _elementRect!: Rectangle | null;\r\n\tprotected _isElementShown!: boolean;\r\n\tprotected _onElementFocusedBound!: ( e: FocusEvent ) => void;\r\n\r\n\tprotected _before!: HTMLDivElement | null;\r\n\tprotected _beforeCreator!: DHtmlElementElementCreator<HTMLDivElement> | null;\r\n\tprotected _beforeStyle!: DHtmlElementStyleBefore<THEME> | undefined;\r\n\tprotected _onBeforeFocusedBound!: ( e: FocusEvent ) => void;\r\n\r\n\tprotected _after!: HTMLDivElement | null;\r\n\tprotected _afterCreator!: DHtmlElementElementCreator<HTMLDivElement> | null;\r\n\tprotected _afterStyle!: DHtmlElementStyleAfter<THEME> | undefined;\r\n\tprotected _onAfterFocusedBound!: ( e: FocusEvent ) => void;\r\n\r\n\tprotected _isStarted!: boolean;\r\n\tprotected _select!: boolean;\r\n\tprotected _doSelectBound!: () => void;\r\n\tprotected _when!: DHtmlElementWhen;\r\n\tprotected _isStartRequested!: boolean;\r\n\r\n\tprotected init( options?: OPTIONS ) {\r\n\t\tsuper.init( options );\r\n\r\n\t\tthis._workPoint = null;\r\n\r\n\t\tconst theme = this.theme;\r\n\t\tconst clipper = options && options.clipper;\r\n\t\tconst clipperCreator = (clipper && clipper.creator) || theme.getClipperCreator();\r\n\t\tthis._clipper = null;\r\n\t\tthis._clipperCreator = clipperCreator;\r\n\t\tthis._clipperRect = null;\r\n\r\n\t\tconst element = options && options.element;\r\n\t\tconst elementCreator = (element && element.creator) || theme.getElementCreator();\r\n\t\tthis._element = null;\r\n\t\tthis._elementCreator = elementCreator;\r\n\t\tthis._elementStyle = element && element.style;\r\n\t\tthis._elementRect = null;\r\n\t\tthis._isElementShown = false;\r\n\t\tthis._onElementFocusedBound = ( e: FocusEvent ): void => {\r\n\t\t\tthis.onElementFocused( e );\r\n\t\t};\r\n\r\n\t\tconst before = options && options.before;\r\n\t\tthis._before = null;\r\n\t\tthis._beforeCreator = (before && before.creator) || theme.getBeforeCreator();\r\n\t\tthis._beforeStyle = before && before.style;\r\n\t\tthis._onBeforeFocusedBound = ( e: FocusEvent ): void => {\r\n\t\t\tthis.onBeforeFocused( e );\r\n\t\t};\r\n\r\n\t\tconst after = options && options.after;\r\n\t\tthis._after = null;\r\n\t\tthis._afterCreator = (after && after.creator) || theme.getAfterCreator();\r\n\t\tthis._afterStyle = after && after.style;\r\n\t\tthis._onAfterFocusedBound = ( e: FocusEvent ): void => {\r\n\t\t\tthis.onAfterFocused( e );\r\n\t\t};\r\n\r\n\t\tthis._isStarted = false;\r\n\t\tthis._select = ( options && options.select != null ?\r\n\t\t\toptions.select : theme.getSelect()\r\n\t\t);\r\n\t\tthis._doSelectBound = () => {\r\n\t\t\tthis.doSelect();\r\n\t\t};\r\n\t\tconst when = ( options && options.when != null ?\r\n\t\t\t( isString( options.when ) ? DHtmlElementWhen[ options.when ] : options.when ) :\r\n\t\t\ttheme.getWhen()\r\n\t\t);\r\n\t\tthis._when = when;\r\n\t\tthis._isStartRequested = ( when === DHtmlElementWhen.ALWAYS );\r\n\t}\r\n\r\n\tget element(): ELEMENT | null {\r\n\t\treturn this._element;\r\n\t}\r\n\r\n\tprotected onDownThis( e: interaction.InteractionEvent ): void {\r\n\t\tconst wasStarted = this._isStarted;\r\n\t\tsuper.onDownThis( e );\r\n\t\tif( ! wasStarted && this._isStarted ) {\r\n\t\t\te.data.originalEvent.preventDefault();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onFocused(): void {\r\n\t\tsuper.onFocused();\r\n\t\tif( this._when === DHtmlElementWhen.FOCUSED ) {\r\n\t\t\tthis.start();\r\n\t\t} else {\r\n\t\t\tconst element = this._element;\r\n\t\t\tif( element ) {\r\n\t\t\t\telement.focus();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onBlured(): void {\r\n\t\tsuper.onBlured();\r\n\t\tif( this._when === DHtmlElementWhen.FOCUSED ) {\r\n\t\t\tthis.onEndByBlured();\r\n\t\t\tthis.cancel();\r\n\t\t} else {\r\n\t\t\tconst element = this._element;\r\n\t\t\tif( element ) {\r\n\t\t\t\telement.blur();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected isStartable(): boolean {\r\n\t\tif( this._when === DHtmlElementWhen.FOCUSED ) {\r\n\t\t\treturn this.isActionable();\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tstart(): void {\r\n\t\tif( ! this._isStarted && this.isStartable() ) {\r\n\t\t\tthis._isStarted = true;\r\n\t\t\tthis.doStart();\r\n\t\t\tDApplications.update( this );\r\n\t\t}\r\n\t}\r\n\r\n\trender( renderer: Renderer ): void {\r\n\t\tif( this._isStartRequested ) {\r\n\t\t\tthis._isStartRequested = false;\r\n\t\t\tthis.doStart();\r\n\t\t}\r\n\t\tif( this._isStarted ) {\r\n\t\t\tthis._isStarted = false;\r\n\t\t}\r\n\t\tsuper.render( renderer );\r\n\t\tif( this._isElementShown ) {\r\n\t\t\tthis.updateElement( renderer );\r\n\t\t}\r\n\t}\r\n\r\n\tprotected doStart( renderer?: Renderer ): void {\r\n\t\tif( ! this._isElementShown ) {\r\n\t\t\tthis._isElementShown = true;\r\n\r\n\t\t\tthis.onStart();\r\n\r\n\t\t\tconst clipper = this.getClipper();\r\n\t\t\tif( clipper ) {\r\n\t\t\t\tconst before = this.getBefore( clipper );\r\n\t\t\t\tconst element = this.getElement( clipper );\r\n\t\t\t\tconst after = this.getAfter( clipper );\r\n\t\t\t\tif( element ) {\r\n\t\t\t\t\tlet resolution = 1;\r\n\t\t\t\t\tif( renderer == null ) {\r\n\t\t\t\t\t\tconst layer = DApplications.getLayer( this );\r\n\t\t\t\t\t\tif( layer ) {\r\n\t\t\t\t\t\t\tresolution = layer.renderer.resolution;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresolution = renderer.resolution;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst elementRect = this.getElementRect( resolution );\r\n\t\t\t\t\tconst clipperRect = this.getClipperRect( elementRect, resolution );\r\n\t\t\t\t\tconst theme = this.theme;\r\n\t\t\t\t\tconst state = this.state;\r\n\t\t\t\t\tconst padding = this._padding;\r\n\t\t\t\t\tthis.setClipperStyle( clipper, state, theme, padding, elementRect, clipperRect );\r\n\t\t\t\t\tthis.setElementStyle( element, state, theme, padding, elementRect, clipperRect );\r\n\t\t\t\t\tif( before ) {\r\n\t\t\t\t\t\tthis.setBeforeStyle( before, theme );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif( after ) {\r\n\t\t\t\t\t\tthis.setAfterStyle( after, theme );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.onElementAttached( element, before, after );\r\n\r\n\t\t\t\t\t// Show HTML elements\r\n\t\t\t\t\tclipper.style.display = \"\";\r\n\t\t\t\t\tif( this.isFocused() ) {\r\n\t\t\t\t\t\telement.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclipper.scrollTop = 0;\r\n\t\t\t\t\tclipper.scrollLeft = 0;\r\n\r\n\t\t\t\t\t// Select the element if required.\r\n\t\t\t\t\tif( this._select ) {\r\n\t\t\t\t\t\tsetTimeout( this._doSelectBound, 0 );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected doSelect(): void {\r\n\t\tconst element = this._element;\r\n\t\tif( element ) {\r\n\t\t\tif( element instanceof HTMLInputElement || element instanceof HTMLTextAreaElement ) {\r\n\t\t\t\t// The following does not work on mobile devices.\r\n\t\t\t\t// I think selecting texts on a tap is annoying.\r\n\t\t\t\t// Though I leave this untouched.\r\n\t\t\t\telement.select();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected createText( formatted: string ): Text | DDynamicText {\r\n\t\tconst result = super.createText( formatted );\r\n\t\tif( this._isElementShown ) {\r\n\t\t\tthis.onStart();\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * Please note that this method does not update transforms.\r\n\t *\r\n\t * @param elementRect\r\n\t * @param resolution\r\n\t */\r\n\tprotected getClipperRect( elementRect: Rectangle, resolution: number ): Rectangle {\r\n\t\tconst point = this._workPoint = ( this._workPoint || new Point( 0, 0 ) );\r\n\t\tconst rect = this._clipperRect = ( this._clipperRect || new Rectangle() );\r\n\r\n\t\tlet x0 = elementRect.x;\r\n\t\tlet y0 = elementRect.y;\r\n\t\tlet x1 = x0 + elementRect.width;\r\n\t\tlet y1 = y0 + elementRect.height;\r\n\r\n\t\tlet current = this.parent;\r\n\t\twhile( current instanceof DBase ) {\r\n\t\t\tcurrent.getClippingRect( this, rect );\r\n\r\n\t\t\tpoint.set( rect.x, rect.y );\r\n\t\t\tcurrent.toGlobal( point, point, false );\r\n\t\t\tconst x = ( (point.x * resolution) | 0 ) / resolution;\r\n\t\t\tconst y = ( (point.y * resolution) | 0 ) / resolution;\r\n\r\n\t\t\tpoint.set( rect.x + rect.width, rect.y + rect.height );\r\n\t\t\tcurrent.toGlobal( point, point, true );\r\n\t\t\tconst w = point.x - x;\r\n\t\t\tconst h = point.y - y;\r\n\r\n\t\t\tx0 = Math.min( Math.max( x0, x ), x + w );\r\n\t\t\ty0 = Math.min( Math.max( y0, y ), y + h );\r\n\r\n\t\t\tx1 = Math.min( Math.max( x1, x ), x + w );\r\n\t\t\ty1 = Math.min( Math.max( y1, y ), y + h );\r\n\r\n\t\t\tcurrent = current.parent;\r\n\t\t}\r\n\r\n\t\trect.x = x0;\r\n\t\trect.y = y0;\r\n\t\trect.width = x1 - x0;\r\n\t\trect.height = y1 - y0;\r\n\t\treturn rect;\r\n\t}\r\n\r\n\t/**\r\n\t * Please note that this method does not update transforms.\r\n\t *\r\n\t * @param resolution\r\n\t */\r\n\tprotected getElementRect( resolution: number ): Rectangle {\r\n\t\tconst point = this._workPoint = ( this._workPoint || new Point( 0, 0 ) );\r\n\t\tconst rect = this._elementRect = ( this._elementRect != null ? this._elementRect : new Rectangle() );\r\n\r\n\t\tpoint.set( 0, 0 );\r\n\t\tthis.toGlobal( point, point, false );\r\n\t\trect.x = point.x;\r\n\t\trect.y = point.y;\r\n\r\n\t\tpoint.set( this.width, this.height );\r\n\t\tthis.toGlobal( point, point, true );\r\n\t\trect.width = point.x - rect.x;\r\n\t\trect.height = point.y - rect.y;\r\n\r\n\t\t// Rounds pixels as Pixi.js does\r\n\t\trect.x = ( (rect.x * resolution) | 0 ) / resolution;\r\n\t\trect.y = ( (rect.y * resolution) | 0 ) / resolution;\r\n\r\n\t\treturn rect;\r\n\t}\r\n\r\n\tcancel(): void {\r\n\t\tif( this._isElementShown ) {\r\n\t\t\tthis._isElementShown = false;\r\n\r\n\t\t\tthis.onCancel();\r\n\r\n\t\t\tconst layer = DApplications.getLayer( this );\r\n\t\t\tif( layer ) {\r\n\t\t\t\tconst view = layer.view;\r\n\t\t\t\tif( this._when === DHtmlElementWhen.FOCUSED && document.activeElement === this._element ) {\r\n\t\t\t\t\tview.focus();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst interactionManager = layer.renderer.plugins.interaction;\r\n\t\t\t\tif( this.containsPoint( interactionManager.mouse.global ) && ! this.isHovered() ) {\r\n\t\t\t\t\tthis.setHovered( true );\r\n\t\t\t\t\tview.style.cursor = this.cursor;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlayer.update();\r\n\t\t\t}\r\n\r\n\t\t\tconst element = this._element;\r\n\t\t\tif( element != null ) {\r\n\t\t\t\tthis.onElementDetached( element, this._before, this._after );\r\n\t\t\t}\r\n\r\n\t\t\tconst clipper = this._clipper;\r\n\t\t\tif( clipper != null ) {\r\n\t\t\t\tclipper.style.display = \"none\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onStart(): void {\r\n\t\t// DO NOTHING\r\n\t}\r\n\r\n\tprotected onCancel(): void {\r\n\t\t// DO NOTHING\r\n\t}\r\n\r\n\tprotected onElementAttached(\r\n\t\telement: ELEMENT, before: HTMLDivElement | null, after: HTMLDivElement | null\r\n\t): void {\r\n\t\tif( before ) {\r\n\t\t\tbefore.addEventListener( \"focus\", this._onBeforeFocusedBound );\r\n\t\t}\r\n\t\tif( after ) {\r\n\t\t\tafter.addEventListener( \"focus\", this._onAfterFocusedBound );\r\n\t\t}\r\n\t\telement.addEventListener( \"focus\", this._onElementFocusedBound, true );\r\n\t}\r\n\r\n\tprotected onElementDetached(\r\n\t\telement: ELEMENT, before: HTMLDivElement | null, after: HTMLDivElement | null\r\n\t): void {\r\n\t\tif( before ) {\r\n\t\t\tbefore.removeEventListener( \"focus\", this._onBeforeFocusedBound );\r\n\t\t}\r\n\t\tif( after ) {\r\n\t\t\tafter.removeEventListener( \"focus\", this._onAfterFocusedBound );\r\n\t\t}\r\n\t\telement.removeEventListener( \"focus\", this._onElementFocusedBound, true );\r\n\t}\r\n\r\n\tprotected getElement( clipper: HTMLDivElement ): ELEMENT | null {\r\n\t\tlet result = this._element;\r\n\t\tif( result == null ) {\r\n\t\t\tconst creator = this._elementCreator;\r\n\t\t\tif( creator ) {\r\n\t\t\t\tresult = creator( clipper );\r\n\t\t\t\tthis._element = result;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected getClipper(): HTMLDivElement | null {\r\n\t\tlet result = this._clipper;\r\n\t\tif( result == null ) {\r\n\t\t\tconst creator = this._clipperCreator;\r\n\t\t\tconst layer = DApplications.getLayer( this );\r\n\t\t\tif( creator && layer ) {\r\n\t\t\t\tresult = creator( layer.getElementContainer() );\r\n\t\t\t\tthis._clipper = result;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected getBefore( clipper: HTMLDivElement ): HTMLDivElement | null {\r\n\t\tlet result = this._before;\r\n\t\tif( result == null ) {\r\n\t\t\tconst creator = this._beforeCreator;\r\n\t\t\tif( creator ) {\r\n\t\t\t\tresult = creator( clipper );\r\n\t\t\t\tthis._before = result;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected getAfter( clipper: HTMLDivElement ): HTMLDivElement | null {\r\n\t\tlet result = this._after;\r\n\t\tif( result == null ) {\r\n\t\t\tconst creator = this._afterCreator;\r\n\t\t\tif( creator ) {\r\n\t\t\t\tresult = creator( clipper );\r\n\t\t\t\tthis._after = result;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected setElementStyle(\r\n\t\ttarget: ELEMENT,\r\n\t\tstate: DBaseState, theme: THEME, padding: DPadding,\r\n\t\telementRect: Rectangle, clipperRect: Rectangle\r\n\t): void {\r\n\t\tconst style = this._elementStyle;\r\n\t\tif( style ) {\r\n\t\t\treturn style( target, state, theme, padding, elementRect, clipperRect );\r\n\t\t} else {\r\n\t\t\treturn this.theme.setElementStyle( target, state, padding, elementRect, clipperRect );\r\n\t\t}\r\n\t}\r\n\r\n\tprotected setClipperStyle(\r\n\t\ttarget: HTMLDivElement,\r\n\t\tstate: DBaseState, theme: THEME, padding: DPadding,\r\n\t\telementRect: Rectangle, clipperRect: Rectangle\r\n\t): void {\r\n\t\tconst style = this._clipperStyle;\r\n\t\tif( style ) {\r\n\t\t\treturn style( target, state, theme, padding, elementRect, clipperRect );\r\n\t\t} else {\r\n\t\t\treturn this.theme.setClipperStyle( target, state, padding, elementRect, clipperRect );\r\n\t\t}\r\n\t}\r\n\r\n\tprotected setBeforeStyle( target: HTMLDivElement, theme: THEME ): void {\r\n\t\tconst style = this._beforeStyle;\r\n\t\tif( style ) {\r\n\t\t\treturn style( target, theme );\r\n\t\t} else {\r\n\t\t\treturn this.theme.setBeforeStyle( target );\r\n\t\t}\r\n\t}\r\n\r\n\tprotected setAfterStyle( target: HTMLDivElement, theme: THEME ): void {\r\n\t\tconst style = this._afterStyle;\r\n\t\tif( style ) {\r\n\t\t\treturn style( target, theme );\r\n\t\t} else {\r\n\t\t\treturn this.theme.setAfterStyle( target );\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onBeforeFocused( e: FocusEvent ): void {\r\n\t\tconst layer = DApplications.getLayer( this );\r\n\t\tif( layer ) {\r\n\t\t\tconst focusController = layer.getFocusController();\r\n\t\t\tconst focusable = focusController.findFocusable( this, false, false, false );\r\n\t\t\tlayer.view.focus();\r\n\t\t\tfocusController.setFocused( focusable, true, true );\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopImmediatePropagation();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onAfterFocused( e: FocusEvent ): void {\r\n\t\tconst layer = DApplications.getLayer( this );\r\n\t\tif( layer ) {\r\n\t\t\tconst focusController = layer.getFocusController();\r\n\t\t\tconst focusable = focusController.findFocusable( this, false, false, true );\r\n\t\t\tlayer.view.focus();\r\n\t\t\tfocusController.setFocused( focusable, true, true );\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopImmediatePropagation();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onElementFocused( e: FocusEvent ): void {\r\n\t\tif( this._when === DHtmlElementWhen.ALWAYS ) {\r\n\t\t\tif( ! this.isFocused() ) {\r\n\t\t\t\tthis.focus();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onEndByBlured(): void {\r\n\t\tthis.onEnd();\r\n\t}\r\n\r\n\tprotected onEnd(): void {\r\n\t\t// DO NOTHING\r\n\t}\r\n\r\n\tend(): void {\r\n\t\tthis.onEnd();\r\n\t\tthis.cancel();\r\n\t}\r\n\r\n\tselect(): this {\r\n\t\tif( this._isElementShown && this._select ) {\r\n\t\t\tthis.doSelect();\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\tprotected updateElement( renderer: Renderer ) {\r\n\t\tif( this._isElementShown ) {\r\n\t\t\tif( this.worldVisible ) {\r\n\t\t\t\tconst element = this._element;\r\n\t\t\t\tconst clipper = this._clipper;\r\n\t\t\t\tif( element && clipper ) {\r\n\t\t\t\t\tconst resolution = renderer.resolution;\r\n\t\t\t\t\tconst elementRect = this.getElementRect( resolution );\r\n\t\t\t\t\tconst clipperRect = this.getClipperRect( elementRect, resolution );\r\n\t\t\t\t\tconst theme = this.theme;\r\n\t\t\t\t\tconst state = this.state;\r\n\t\t\t\t\tconst padding = this._padding;\r\n\t\t\t\t\tthis.setClipperStyle( clipper, state, theme, padding, elementRect, clipperRect );\r\n\t\t\t\t\tthis.setElementStyle( element, state, theme, padding, elementRect, clipperRect );\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.cancel();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected getType(): string {\r\n\t\treturn \"DHtmlElement\";\r\n\t}\r\n}\r\n"]}